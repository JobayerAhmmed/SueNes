~/hebi/anti-rouge $ bash runner.sh
EXP 3
Mon Dec 10 14:15:16 CST 2018
python3 main.py neg InferSent FC
Using TensorFlow backend.
loading data ..
loading 0 ..
loading 1 ..
loading 2 ..
loading 3 ..
loading 4 ..
loading 5 ..
loading 6 ..
loading 7 ..
loading 8 ..
loading 9 ..
loading 10 ..
loading 11 ..
loading 12 ..
loading 13 ..
loading 14 ..
loading 15 ..
loading 16 ..
loading 17 ..
loading 18 ..
loading 19 ..
loading 20 ..
loading 21 ..
loading 22 ..
loading 23 ..
loading 24 ..
loading 25 ..
loading 26 ..
loading 27 ..
loading 28 ..
loading 29 ..
concatenating ..
train:  (48000, 50, 4096) (48000,)
val:  (6000, 50, 4096) (6000,)
test:  (6000, 50, 4096) (6000,)
building model ..
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 50, 4096)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 204800)            0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               26214528  
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 26,214,657
Trainable params: 26,214,657
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/60
2018-12-10 14:18:01.271586: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-10 14:18:01.523791: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:0a:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2018-12-10 14:18:01.523823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-10 14:18:02.047205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-10 14:18:02.047239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-10 14:18:02.047249: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-10 14:18:02.047767: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10407 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:0a:00.0, compute capability: 6.1)
48000/48000 [==============================] - 66s 1ms/step - loss: 0.6679 - acc: 0.5569 - pearson_correlation_f: 0.2416 - val_loss: 0.7210 - val_acc: 0.5633 - val_pearson_correlation_f: 0.2885
Epoch 2/60
48000/48000 [==============================] - 64s 1ms/step - loss: 0.5919 - acc: 0.6596 - pearson_correlation_f: 0.4626 - val_loss: 0.4532 - val_acc: 0.8445 - val_pearson_correlation_f: 0.6934
Epoch 3/60
48000/48000 [==============================] - 63s 1ms/step - loss: 0.4667 - acc: 0.7795 - pearson_correlation_f: 0.7020 - val_loss: 0.4833 - val_acc: 0.6855 - val_pearson_correlation_f: 0.7615
Epoch 4/60
48000/48000 [==============================] - 63s 1ms/step - loss: 0.3541 - acc: 0.8524 - pearson_correlation_f: 0.8051 - val_loss: 0.2647 - val_acc: 0.9160 - val_pearson_correlation_f: 0.8514
Epoch 5/60
48000/48000 [==============================] - 63s 1ms/step - loss: 0.2718 - acc: 0.8917 - pearson_correlation_f: 0.8565 - val_loss: 0.3455 - val_acc: 0.8495 - val_pearson_correlation_f: 0.8027
Epoch 6/60
48000/48000 [==============================] - 63s 1ms/step - loss: 0.2125 - acc: 0.9201 - pearson_correlation_f: 0.8899 - val_loss: 0.1978 - val_acc: 0.9292 - val_pearson_correlation_f: 0.8891
Epoch 7/60
48000/48000 [==============================] - 63s 1ms/step - loss: 0.1701 - acc: 0.9354 - pearson_correlation_f: 0.9112 - val_loss: 0.2974 - val_acc: 0.8598 - val_pearson_correlation_f: 0.8271
Epoch 8/60
48000/48000 [==============================] - 62s 1ms/step - loss: 0.1397 - acc: 0.9501 - pearson_correlation_f: 0.9283 - val_loss: 0.1561 - val_acc: 0.9465 - val_pearson_correlation_f: 0.9141
Epoch 9/60
48000/48000 [==============================] - 64s 1ms/step - loss: 0.1117 - acc: 0.9609 - pearson_correlation_f: 0.9433 - val_loss: 0.1381 - val_acc: 0.9563 - val_pearson_correlation_f: 0.9266
Epoch 10/60
48000/48000 [==============================] - 63s 1ms/step - loss: 0.0962 - acc: 0.9656 - pearson_correlation_f: 0.9507 - val_loss: 0.1398 - val_acc: 0.9570 - val_pearson_correlation_f: 0.9279
Epoch 11/60
48000/48000 [==============================] - 63s 1ms/step - loss: 0.0895 - acc: 0.9683 - pearson_correlation_f: 0.9546 - val_loss: 0.1365 - val_acc: 0.9562 - val_pearson_correlation_f: 0.9285
Epoch 12/60
48000/48000 [==============================] - 61s 1ms/step - loss: 0.0734 - acc: 0.9733 - pearson_correlation_f: 0.9618 - val_loss: 0.1414 - val_acc: 0.9583 - val_pearson_correlation_f: 0.9284
Epoch 13/60
48000/48000 [==============================] - 62s 1ms/step - loss: 0.0692 - acc: 0.9759 - pearson_correlation_f: 0.9647 - val_loss: 0.1392 - val_acc: 0.9592 - val_pearson_correlation_f: 0.9299
Epoch 14/60
48000/48000 [==============================] - 61s 1ms/step - loss: 0.0611 - acc: 0.9783 - pearson_correlation_f: 0.9687 - val_loss: 0.1434 - val_acc: 0.9602 - val_pearson_correlation_f: 0.9315
6000/6000 [==============================] - 3s 451us/step
Test result:  [0.13633573307966193, 0.9618333333333333, 0.9362003281911214]
python3 main.py neg InferSent CNN
Using TensorFlow backend.
loading data ..
loading 0 ..
loading 1 ..
loading 2 ..
loading 3 ..
loading 4 ..
loading 5 ..
loading 6 ..
loading 7 ..
loading 8 ..
loading 9 ..
loading 10 ..
loading 11 ..
loading 12 ..
loading 13 ..
loading 14 ..
loading 15 ..
loading 16 ..
loading 17 ..
loading 18 ..
loading 19 ..
loading 20 ..
loading 21 ..
loading 22 ..
loading 23 ..
loading 24 ..
loading 25 ..
loading 26 ..
loading 27 ..
loading 28 ..
loading 29 ..
concatenating ..
train:  (48000, 50, 4096) (48000,)
val:  (6000, 50, 4096) (6000,)
test:  (6000, 50, 4096) (6000,)
building model ..
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 50, 4096)          0         
_________________________________________________________________
conv1d_1 (Conv1D)            (None, 46, 128)           2621568   
_________________________________________________________________
max_pooling1d_1 (MaxPooling1 (None, 15, 128)           0         
_________________________________________________________________
global_max_pooling1d_1 (Glob (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 2,638,209
Trainable params: 2,638,209
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/60
2018-12-10 14:35:30.593707: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-10 14:35:30.861720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:0a:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2018-12-10 14:35:30.861756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-10 14:35:31.418505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-10 14:35:31.418540: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-10 14:35:31.418550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-10 14:35:31.419064: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10407 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:0a:00.0, compute capability: 6.1)
48000/48000 [==============================] - 68s 1ms/step - loss: 0.5279 - acc: 0.6848 - pearson_correlation_f: 0.4626 - val_loss: 0.4007 - val_acc: 0.8533 - val_pearson_correlation_f: 0.7803
Epoch 2/60
48000/48000 [==============================] - 64s 1ms/step - loss: 0.2253 - acc: 0.9260 - pearson_correlation_f: 0.8695 - val_loss: 0.1972 - val_acc: 0.9392 - val_pearson_correlation_f: 0.8841
Epoch 3/60
48000/48000 [==============================] - 64s 1ms/step - loss: 0.1969 - acc: 0.9377 - pearson_correlation_f: 0.8847 - val_loss: 0.1994 - val_acc: 0.9385 - val_pearson_correlation_f: 0.8846
Epoch 4/60
48000/48000 [==============================] - 63s 1ms/step - loss: 0.1892 - acc: 0.9391 - pearson_correlation_f: 0.8891 - val_loss: 0.2408 - val_acc: 0.9185 - val_pearson_correlation_f: 0.8584
Epoch 5/60
48000/48000 [==============================] - 64s 1ms/step - loss: 0.1824 - acc: 0.9406 - pearson_correlation_f: 0.8935 - val_loss: 0.1994 - val_acc: 0.9360 - val_pearson_correlation_f: 0.8810
6000/6000 [==============================] - 3s 488us/step
Test result:  [0.19862831479310988, 0.9365, 0.8837509741783142]
python3 main.py neg InferSent LSTM
Using TensorFlow backend.
loading data ..
loading 0 ..
loading 1 ..
loading 2 ..
loading 3 ..
loading 4 ..
loading 5 ..
loading 6 ..
loading 7 ..
loading 8 ..
loading 9 ..
loading 10 ..
loading 11 ..
loading 12 ..
loading 13 ..
loading 14 ..
loading 15 ..
loading 16 ..
loading 17 ..
loading 18 ..
loading 19 ..
loading 20 ..
loading 21 ..
loading 22 ..
loading 23 ..
loading 24 ..
loading 25 ..
loading 26 ..
loading 27 ..
loading 28 ..
loading 29 ..
concatenating ..
train:  (48000, 50, 4096) (48000,)
val:  (6000, 50, 4096) (6000,)
test:  (6000, 50, 4096) (6000,)
building model ..
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 50, 4096)          0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 25)                412200    
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 26        
=================================================================
Total params: 412,226
Trainable params: 412,226
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/60
2018-12-10 14:43:42.417135: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-10 14:43:42.671212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.62
pciBusID: 0000:0a:00.0
totalMemory: 10.92GiB freeMemory: 10.76GiB
2018-12-10 14:43:42.671246: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-10 14:43:43.204285: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-10 14:43:43.204319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-10 14:43:43.204328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-10 14:43:43.204847: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10407 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:0a:00.0, compute capability: 6.1)
48000/48000 [==============================] - 96s 2ms/step - loss: 0.5318 - acc: 0.7008 - pearson_correlation_f: 0.4337 - val_loss: 0.2185 - val_acc: 0.9357 - val_pearson_correlation_f: 0.8748
Epoch 2/60
48000/48000 [==============================] - 94s 2ms/step - loss: 0.2006 - acc: 0.9377 - pearson_correlation_f: 0.8837 - val_loss: 0.1953 - val_acc: 0.9395 - val_pearson_correlation_f: 0.8850
Epoch 3/60
48000/48000 [==============================] - 92s 2ms/step - loss: 0.1870 - acc: 0.9419 - pearson_correlation_f: 0.8905 - val_loss: 0.2412 - val_acc: 0.9135 - val_pearson_correlation_f: 0.8524
Epoch 4/60
48000/48000 [==============================] - 93s 2ms/step - loss: 0.1840 - acc: 0.9421 - pearson_correlation_f: 0.8921 - val_loss: 0.1990 - val_acc: 0.9373 - val_pearson_correlation_f: 0.8817
Epoch 5/60
48000/48000 [==============================] - 92s 2ms/step - loss: 0.1805 - acc: 0.9423 - pearson_correlation_f: 0.8938 - val_loss: 0.1907 - val_acc: 0.9393 - val_pearson_correlation_f: 0.8874
Epoch 6/60
48000/48000 [==============================] - 92s 2ms/step - loss: 0.1730 - acc: 0.9432 - pearson_correlation_f: 0.8985 - val_loss: 0.1888 - val_acc: 0.9387 - val_pearson_correlation_f: 0.8878
Epoch 7/60
48000/48000 [==============================] - 93s 2ms/step - loss: 0.1628 - acc: 0.9462 - pearson_correlation_f: 0.9054 - val_loss: 0.1800 - val_acc: 0.9417 - val_pearson_correlation_f: 0.8941
Epoch 8/60
48000/48000 [==============================] - 94s 2ms/step - loss: 0.1515 - acc: 0.9494 - pearson_correlation_f: 0.9126 - val_loss: 0.1860 - val_acc: 0.9445 - val_pearson_correlation_f: 0.9000
Epoch 9/60
48000/48000 [==============================] - 92s 2ms/step - loss: 0.1407 - acc: 0.9533 - pearson_correlation_f: 0.9202 - val_loss: 0.1720 - val_acc: 0.9458 - val_pearson_correlation_f: 0.9029
Epoch 10/60
48000/48000 [==============================] - 92s 2ms/step - loss: 0.1309 - acc: 0.9566 - pearson_correlation_f: 0.9264 - val_loss: 0.1732 - val_acc: 0.9478 - val_pearson_correlation_f: 0.9067
Epoch 11/60
48000/48000 [==============================] - 91s 2ms/step - loss: 0.1215 - acc: 0.9600 - pearson_correlation_f: 0.9327 - val_loss: 0.1662 - val_acc: 0.9467 - val_pearson_correlation_f: 0.9063
Epoch 12/60
48000/48000 [==============================] - 92s 2ms/step - loss: 0.1142 - acc: 0.9622 - pearson_correlation_f: 0.9368 - val_loss: 0.1618 - val_acc: 0.9492 - val_pearson_correlation_f: 0.9107
Epoch 13/60
48000/48000 [==============================] - 95s 2ms/step - loss: 0.1068 - acc: 0.9651 - pearson_correlation_f: 0.9415 - val_loss: 0.1792 - val_acc: 0.9487 - val_pearson_correlation_f: 0.9090
Epoch 14/60
48000/48000 [==============================] - 94s 2ms/step - loss: 0.1002 - acc: 0.9671 - pearson_correlation_f: 0.9453 - val_loss: 0.1701 - val_acc: 0.9493 - val_pearson_correlation_f: 0.9120
Epoch 15/60
48000/48000 [==============================] - 94s 2ms/step - loss: 0.0923 - acc: 0.9695 - pearson_correlation_f: 0.9498 - val_loss: 0.1841 - val_acc: 0.9493 - val_pearson_correlation_f: 0.9115
6000/6000 [==============================] - 10s 2ms/step
Test result:  [0.15680752420425415, 0.9563333333333334, 0.9232129683494568]
Mon Dec 10 15:07:12 CST 2018
DONE!!!
