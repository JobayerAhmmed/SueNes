In [3]: run_all_exp(['neg'], ['glove', 'USE', 'USE-Large', 'InferSent'],
   ...:             [5000], [1], ['CNN'])
Setting:  neg glove 5000 1 CNN None
loading data ..
merging data ..
creating tokenizer ..
padding ..
shuffling ..
splitting ..
train:  (8000, 640) (8000,)
val:  (1000, 640) (1000,)
test:  (1000, 640) (1000,)
building model ..
Indexing word vectors.
Found 400000 word vectors.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 640)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 640, 100)          6613500   
_________________________________________________________________
conv1d_1 (Conv1D)            (None, 636, 128)          64128     
_________________________________________________________________
max_pooling1d_1 (MaxPooling1 (None, 212, 128)          0         
_________________________________________________________________
global_max_pooling1d_1 (Glob (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 6,694,269
Trainable params: 80,769
Non-trainable params: 6,613,500
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
2018-12-07 01:02:25.293332: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-07 01:02:25.382274: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-07 01:02:25.382718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.21GiB
2018-12-07 01:02:25.382740: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-07 01:02:25.543283: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-07 01:02:25.543316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-07 01:02:25.543322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-07 01:02:25.543453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1902 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
8000/8000 [==============================] - 3s 354us/step - loss: 0.7015 - acc: 0.4970 - pearson_correlation_f: -0.0036 - val_loss: 0.7642 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0338
Epoch 2/20
8000/8000 [==============================] - 1s 151us/step - loss: 0.7262 - acc: 0.5035 - pearson_correlation_f: -0.0275 - val_loss: 0.6929 - val_acc: 0.5190 - val_pearson_correlation_f: 0.0535
Epoch 3/20
8000/8000 [==============================] - 1s 150us/step - loss: 0.7149 - acc: 0.4956 - pearson_correlation_f: -0.0511 - val_loss: 0.6942 - val_acc: 0.5070 - val_pearson_correlation_f: 0.1025
Epoch 4/20
8000/8000 [==============================] - 1s 151us/step - loss: 0.7033 - acc: 0.5081 - pearson_correlation_f: 0.0717 - val_loss: 0.7513 - val_acc: 0.5000 - val_pearson_correlation_f: 0.1362
Epoch 5/20
8000/8000 [==============================] - 1s 151us/step - loss: 0.6904 - acc: 0.5371 - pearson_correlation_f: 0.2177 - val_loss: 0.6785 - val_acc: 0.5440 - val_pearson_correlation_f: 0.3047
Epoch 6/20
8000/8000 [==============================] - 1s 150us/step - loss: 0.6721 - acc: 0.5767 - pearson_correlation_f: 0.3038 - val_loss: 0.6579 - val_acc: 0.6020 - val_pearson_correlation_f: 0.3610
Epoch 7/20
8000/8000 [==============================] - 1s 151us/step - loss: 0.6506 - acc: 0.6200 - pearson_correlation_f: 0.3733 - val_loss: 0.6583 - val_acc: 0.5850 - val_pearson_correlation_f: 0.3951
Epoch 8/20
8000/8000 [==============================] - 1s 150us/step - loss: 0.6283 - acc: 0.6394 - pearson_correlation_f: 0.4325 - val_loss: 0.6417 - val_acc: 0.6300 - val_pearson_correlation_f: 0.4070
Epoch 9/20
8000/8000 [==============================] - 1s 152us/step - loss: 0.6075 - acc: 0.6703 - pearson_correlation_f: 0.4821 - val_loss: 0.6389 - val_acc: 0.6420 - val_pearson_correlation_f: 0.4144
Epoch 10/20
8000/8000 [==============================] - 1s 153us/step - loss: 0.5814 - acc: 0.6926 - pearson_correlation_f: 0.5364 - val_loss: 0.5952 - val_acc: 0.6830 - val_pearson_correlation_f: 0.4315
Epoch 11/20
8000/8000 [==============================] - 1s 153us/step - loss: 0.5557 - acc: 0.7144 - pearson_correlation_f: 0.5790 - val_loss: 0.6356 - val_acc: 0.6400 - val_pearson_correlation_f: 0.4479
Epoch 12/20
8000/8000 [==============================] - 1s 151us/step - loss: 0.5330 - acc: 0.7295 - pearson_correlation_f: 0.6235 - val_loss: 0.6061 - val_acc: 0.6720 - val_pearson_correlation_f: 0.4592
Epoch 13/20
8000/8000 [==============================] - 1s 152us/step - loss: 0.5072 - acc: 0.7440 - pearson_correlation_f: 0.6577 - val_loss: 0.5756 - val_acc: 0.7000 - val_pearson_correlation_f: 0.4646
Epoch 14/20
8000/8000 [==============================] - 1s 152us/step - loss: 0.4821 - acc: 0.7612 - pearson_correlation_f: 0.6960 - val_loss: 0.5888 - val_acc: 0.7040 - val_pearson_correlation_f: 0.4758
Epoch 15/20
8000/8000 [==============================] - 1s 151us/step - loss: 0.4659 - acc: 0.7751 - pearson_correlation_f: 0.7228 - val_loss: 0.6494 - val_acc: 0.6550 - val_pearson_correlation_f: 0.4662
Epoch 16/20
8000/8000 [==============================] - 1s 152us/step - loss: 0.4402 - acc: 0.7812 - pearson_correlation_f: 0.7474 - val_loss: 0.6029 - val_acc: 0.6960 - val_pearson_correlation_f: 0.4701
Epoch 17/20
8000/8000 [==============================] - 1s 152us/step - loss: 0.4198 - acc: 0.8023 - pearson_correlation_f: 0.7675 - val_loss: 0.6459 - val_acc: 0.6640 - val_pearson_correlation_f: 0.4619
Epoch 18/20
8000/8000 [==============================] - 1s 153us/step - loss: 0.3920 - acc: 0.8234 - pearson_correlation_f: 0.7907 - val_loss: 0.7041 - val_acc: 0.6590 - val_pearson_correlation_f: 0.4706
Epoch 19/20
8000/8000 [==============================] - 1s 153us/step - loss: 0.3825 - acc: 0.8257 - pearson_correlation_f: 0.8071 - val_loss: 0.5921 - val_acc: 0.7000 - val_pearson_correlation_f: 0.4759
Epoch 20/20
8000/8000 [==============================] - 1s 152us/step - loss: 0.3630 - acc: 0.8376 - pearson_correlation_f: 0.8227 - val_loss: 0.6158 - val_acc: 0.6850 - val_pearson_correlation_f: 0.4711
1000/1000 [==============================] - 0s 84us/step
Test result:  [0.6367098922729493, 0.701, 0.45476745891571047]
SETTING: neg glove 5000 1 CNN
RESULT: 0.701
Setting:  neg USE 5000 1 CNN None
loading data ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (8000, 13, 512) (8000,)
val:  (1000, 13, 512) (1000,)
test:  (1000, 13, 512) (1000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
conv1d_2 (Conv1D)            (None, 9, 128)            327808    
_________________________________________________________________
max_pooling1d_2 (MaxPooling1 (None, 3, 128)            0         
_________________________________________________________________
global_max_pooling1d_2 (Glob (None, 128)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 129       
=================================================================
Total params: 344,449
Trainable params: 344,449
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
8000/8000 [==============================] - 1s 81us/step - loss: 0.6935 - acc: 0.5007 - pearson_correlation_f: 0.0048 - val_loss: 0.6932 - val_acc: 0.5030 - val_pearson_correlation_f: 0.0202
Epoch 2/20
8000/8000 [==============================] - 0s 46us/step - loss: 0.6935 - acc: 0.4940 - pearson_correlation_f: 0.0015 - val_loss: 0.6932 - val_acc: 0.5010 - val_pearson_correlation_f: 0.0669
Epoch 3/20
8000/8000 [==============================] - 0s 47us/step - loss: 0.6940 - acc: 0.5036 - pearson_correlation_f: 0.0265 - val_loss: 0.6879 - val_acc: 0.5160 - val_pearson_correlation_f: 0.2514
Epoch 4/20
8000/8000 [==============================] - 0s 47us/step - loss: 0.6746 - acc: 0.5804 - pearson_correlation_f: 0.2888 - val_loss: 0.6658 - val_acc: 0.5570 - val_pearson_correlation_f: 0.3726
Epoch 5/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.6178 - acc: 0.6609 - pearson_correlation_f: 0.4604 - val_loss: 0.5825 - val_acc: 0.6980 - val_pearson_correlation_f: 0.5089
Epoch 6/20
8000/8000 [==============================] - 0s 47us/step - loss: 0.5515 - acc: 0.7226 - pearson_correlation_f: 0.5768 - val_loss: 0.5436 - val_acc: 0.7140 - val_pearson_correlation_f: 0.5912
Epoch 7/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.4955 - acc: 0.7608 - pearson_correlation_f: 0.6526 - val_loss: 0.5432 - val_acc: 0.6960 - val_pearson_correlation_f: 0.6041
Epoch 8/20
8000/8000 [==============================] - 0s 47us/step - loss: 0.4452 - acc: 0.7926 - pearson_correlation_f: 0.7076 - val_loss: 0.4879 - val_acc: 0.7520 - val_pearson_correlation_f: 0.6443
Epoch 9/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.3928 - acc: 0.8282 - pearson_correlation_f: 0.7568 - val_loss: 0.7960 - val_acc: 0.6160 - val_pearson_correlation_f: 0.5440
Epoch 10/20
8000/8000 [==============================] - 0s 47us/step - loss: 0.3618 - acc: 0.8390 - pearson_correlation_f: 0.7888 - val_loss: 0.5232 - val_acc: 0.7470 - val_pearson_correlation_f: 0.6413
Epoch 11/20
8000/8000 [==============================] - 0s 48us/step - loss: 0.3179 - acc: 0.8710 - pearson_correlation_f: 0.8229 - val_loss: 0.5055 - val_acc: 0.7560 - val_pearson_correlation_f: 0.6390
Epoch 12/20
8000/8000 [==============================] - 0s 47us/step - loss: 0.2889 - acc: 0.8811 - pearson_correlation_f: 0.8466 - val_loss: 0.4126 - val_acc: 0.8110 - val_pearson_correlation_f: 0.6834
Epoch 13/20
8000/8000 [==============================] - 0s 43us/step - loss: 0.2622 - acc: 0.8954 - pearson_correlation_f: 0.8664 - val_loss: 0.4366 - val_acc: 0.7900 - val_pearson_correlation_f: 0.6721
Epoch 14/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.2351 - acc: 0.9130 - pearson_correlation_f: 0.8854 - val_loss: 0.4412 - val_acc: 0.7980 - val_pearson_correlation_f: 0.6780
Epoch 15/20
8000/8000 [==============================] - 0s 46us/step - loss: 0.2019 - acc: 0.9250 - pearson_correlation_f: 0.9043 - val_loss: 0.7488 - val_acc: 0.6970 - val_pearson_correlation_f: 0.5982
Epoch 16/20
8000/8000 [==============================] - 0s 47us/step - loss: 0.1844 - acc: 0.9309 - pearson_correlation_f: 0.9148 - val_loss: 0.6108 - val_acc: 0.7470 - val_pearson_correlation_f: 0.6296
Epoch 17/20
8000/8000 [==============================] - 0s 48us/step - loss: 0.1725 - acc: 0.9382 - pearson_correlation_f: 0.9209 - val_loss: 0.4858 - val_acc: 0.7940 - val_pearson_correlation_f: 0.6631
Epoch 18/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.1489 - acc: 0.9487 - pearson_correlation_f: 0.9347 - val_loss: 0.4881 - val_acc: 0.7790 - val_pearson_correlation_f: 0.6589
Epoch 19/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.1206 - acc: 0.9597 - pearson_correlation_f: 0.9482 - val_loss: 0.4898 - val_acc: 0.8170 - val_pearson_correlation_f: 0.6688
Epoch 20/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.1083 - acc: 0.9634 - pearson_correlation_f: 0.9543 - val_loss: 0.4999 - val_acc: 0.7970 - val_pearson_correlation_f: 0.6681
1000/1000 [==============================] - 0s 58us/step
Test result:  [0.5656519899368286, 0.789, 0.6457230954170227]
SETTING: neg USE 5000 1 CNN
RESULT: 0.789
Setting:  neg USE-Large 5000 1 CNN None
loading data ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (8000, 13, 512) (8000,)
val:  (1000, 13, 512) (1000,)
test:  (1000, 13, 512) (1000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
conv1d_3 (Conv1D)            (None, 9, 128)            327808    
_________________________________________________________________
max_pooling1d_3 (MaxPooling1 (None, 3, 128)            0         
_________________________________________________________________
global_max_pooling1d_3 (Glob (None, 128)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_6 (Dense)              (None, 1)                 129       
=================================================================
Total params: 344,449
Trainable params: 344,449
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
8000/8000 [==============================] - 1s 84us/step - loss: 0.6934 - acc: 0.5012 - pearson_correlation_f: -0.0022 - val_loss: 0.6933 - val_acc: 0.5000 - val_pearson_correlation_f: 4.7761e-04
Epoch 2/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.6934 - acc: 0.5114 - pearson_correlation_f: -0.0053 - val_loss: 0.6976 - val_acc: 0.5000 - val_pearson_correlation_f: 3.8835e-04
Epoch 3/20
8000/8000 [==============================] - 0s 44us/step - loss: 0.6935 - acc: 0.5066 - pearson_correlation_f: 0.0486 - val_loss: 0.6872 - val_acc: 0.5280 - val_pearson_correlation_f: 0.3087
Epoch 4/20
8000/8000 [==============================] - 0s 46us/step - loss: 0.6599 - acc: 0.6188 - pearson_correlation_f: 0.3886 - val_loss: 0.6407 - val_acc: 0.6160 - val_pearson_correlation_f: 0.4809
Epoch 5/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.5740 - acc: 0.7116 - pearson_correlation_f: 0.5536 - val_loss: 0.5311 - val_acc: 0.7600 - val_pearson_correlation_f: 0.5838
Epoch 6/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.5033 - acc: 0.7736 - pearson_correlation_f: 0.6512 - val_loss: 0.5342 - val_acc: 0.7060 - val_pearson_correlation_f: 0.6184
Epoch 7/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.4515 - acc: 0.8016 - pearson_correlation_f: 0.7110 - val_loss: 0.4709 - val_acc: 0.7730 - val_pearson_correlation_f: 0.6403
Epoch 8/20
8000/8000 [==============================] - 0s 44us/step - loss: 0.3994 - acc: 0.8246 - pearson_correlation_f: 0.7558 - val_loss: 0.4828 - val_acc: 0.7610 - val_pearson_correlation_f: 0.6507
Epoch 9/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.3680 - acc: 0.8424 - pearson_correlation_f: 0.7871 - val_loss: 0.4334 - val_acc: 0.8130 - val_pearson_correlation_f: 0.6712
Epoch 10/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.3301 - acc: 0.8658 - pearson_correlation_f: 0.8205 - val_loss: 0.4151 - val_acc: 0.8110 - val_pearson_correlation_f: 0.6871
Epoch 11/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.3099 - acc: 0.8741 - pearson_correlation_f: 0.8381 - val_loss: 0.4138 - val_acc: 0.8150 - val_pearson_correlation_f: 0.7028
Epoch 12/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.2772 - acc: 0.8912 - pearson_correlation_f: 0.8632 - val_loss: 0.4041 - val_acc: 0.8200 - val_pearson_correlation_f: 0.7063
Epoch 13/20
8000/8000 [==============================] - 0s 46us/step - loss: 0.2545 - acc: 0.9005 - pearson_correlation_f: 0.8749 - val_loss: 0.4431 - val_acc: 0.8060 - val_pearson_correlation_f: 0.6895
Epoch 14/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.2156 - acc: 0.9221 - pearson_correlation_f: 0.8978 - val_loss: 0.4089 - val_acc: 0.8240 - val_pearson_correlation_f: 0.7124
Epoch 15/20
8000/8000 [==============================] - 0s 43us/step - loss: 0.2121 - acc: 0.9176 - pearson_correlation_f: 0.8999 - val_loss: 0.5695 - val_acc: 0.7430 - val_pearson_correlation_f: 0.6591
Epoch 16/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.1851 - acc: 0.9336 - pearson_correlation_f: 0.9154 - val_loss: 0.4196 - val_acc: 0.8220 - val_pearson_correlation_f: 0.7110
Epoch 17/20
8000/8000 [==============================] - 0s 44us/step - loss: 0.1593 - acc: 0.9442 - pearson_correlation_f: 0.9302 - val_loss: 0.4085 - val_acc: 0.8300 - val_pearson_correlation_f: 0.7181
Epoch 18/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.1454 - acc: 0.9507 - pearson_correlation_f: 0.9374 - val_loss: 0.5938 - val_acc: 0.7900 - val_pearson_correlation_f: 0.6794
Epoch 19/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.1354 - acc: 0.9541 - pearson_correlation_f: 0.9408 - val_loss: 0.4070 - val_acc: 0.8300 - val_pearson_correlation_f: 0.7223
Epoch 20/20
8000/8000 [==============================] - 0s 45us/step - loss: 0.1313 - acc: 0.9530 - pearson_correlation_f: 0.9428 - val_loss: 0.4182 - val_acc: 0.8320 - val_pearson_correlation_f: 0.7203
1000/1000 [==============================] - 0s 54us/step
Test result:  [0.4153028461933136, 0.844, 0.7340814785957337]
SETTING: neg USE-Large 5000 1 CNN
RESULT: 0.844
Setting:  neg InferSent 5000 1 CNN None
loading data ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (8000, 13, 4096) (8000,)
val:  (1000, 13, 4096) (1000,)
test:  (1000, 13, 4096) (1000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 13, 4096)          0         
_________________________________________________________________
conv1d_4 (Conv1D)            (None, 9, 128)            2621568   
_________________________________________________________________
max_pooling1d_4 (MaxPooling1 (None, 3, 128)            0         
_________________________________________________________________
global_max_pooling1d_4 (Glob (None, 128)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_8 (Dense)              (None, 1)                 129       
=================================================================
Total params: 2,638,209
Trainable params: 2,638,209
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
2018-12-07 01:05:01.612547: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.26GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
7680/8000 [===========================>..] - ETA: 0s - loss: 0.6933 - acc: 0.4991 - pearson_correlation_f: -0.00402018-12-07 01:05:03.274525: W tensorflow/core/common_runtime/bfc_allocator.cc:211] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.05GiB. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
8000/8000 [==============================] - 3s 423us/step - loss: 0.6934 - acc: 0.4975 - pearson_correlation_f: -0.0042 - val_loss: 0.6932 - val_acc: 0.5110 - val_pearson_correlation_f: 0.0066
Epoch 2/20
8000/8000 [==============================] - 1s 167us/step - loss: 0.6953 - acc: 0.4871 - pearson_correlation_f: -0.0164 - val_loss: 0.6922 - val_acc: 0.5210 - val_pearson_correlation_f: 0.0619
Epoch 3/20
8000/8000 [==============================] - 1s 169us/step - loss: 0.6963 - acc: 0.5030 - pearson_correlation_f: 0.0261 - val_loss: 0.7557 - val_acc: 0.4990 - val_pearson_correlation_f: 0.0102
Epoch 4/20
8000/8000 [==============================] - 1s 172us/step - loss: 0.6987 - acc: 0.5215 - pearson_correlation_f: 0.0585 - val_loss: 0.6853 - val_acc: 0.5340 - val_pearson_correlation_f: 0.1668
Epoch 5/20
8000/8000 [==============================] - 1s 168us/step - loss: 0.6818 - acc: 0.5503 - pearson_correlation_f: 0.1984 - val_loss: 0.6829 - val_acc: 0.5590 - val_pearson_correlation_f: 0.2341
Epoch 6/20
8000/8000 [==============================] - 1s 165us/step - loss: 0.6557 - acc: 0.5866 - pearson_correlation_f: 0.2954 - val_loss: 0.6712 - val_acc: 0.5500 - val_pearson_correlation_f: 0.2309
Epoch 7/20
8000/8000 [==============================] - 1s 167us/step - loss: 0.6309 - acc: 0.6052 - pearson_correlation_f: 0.3549 - val_loss: 0.6390 - val_acc: 0.5770 - val_pearson_correlation_f: 0.3120
Epoch 8/20
8000/8000 [==============================] - 1s 168us/step - loss: 0.6097 - acc: 0.6284 - pearson_correlation_f: 0.3991 - val_loss: 0.6318 - val_acc: 0.6150 - val_pearson_correlation_f: 0.3665
Epoch 9/20
8000/8000 [==============================] - 1s 168us/step - loss: 0.5842 - acc: 0.6599 - pearson_correlation_f: 0.4497 - val_loss: 0.6075 - val_acc: 0.6390 - val_pearson_correlation_f: 0.3882
Epoch 10/20
8000/8000 [==============================] - 1s 169us/step - loss: 0.5580 - acc: 0.6844 - pearson_correlation_f: 0.5016 - val_loss: 0.6052 - val_acc: 0.6380 - val_pearson_correlation_f: 0.3965
Epoch 11/20
8000/8000 [==============================] - 1s 168us/step - loss: 0.5262 - acc: 0.7165 - pearson_correlation_f: 0.5507 - val_loss: 0.6165 - val_acc: 0.6360 - val_pearson_correlation_f: 0.3825
Epoch 12/20
8000/8000 [==============================] - 1s 168us/step - loss: 0.4930 - acc: 0.7454 - pearson_correlation_f: 0.6054 - val_loss: 0.7048 - val_acc: 0.5820 - val_pearson_correlation_f: 0.3181
Epoch 13/20
8000/8000 [==============================] - 1s 168us/step - loss: 0.4624 - acc: 0.7685 - pearson_correlation_f: 0.6532 - val_loss: 0.6091 - val_acc: 0.6600 - val_pearson_correlation_f: 0.4216
Epoch 14/20
8000/8000 [==============================] - 1s 170us/step - loss: 0.4249 - acc: 0.7931 - pearson_correlation_f: 0.6905 - val_loss: 0.5929 - val_acc: 0.6720 - val_pearson_correlation_f: 0.4404
Epoch 15/20
8000/8000 [==============================] - 1s 169us/step - loss: 0.3963 - acc: 0.8107 - pearson_correlation_f: 0.7278 - val_loss: 0.6383 - val_acc: 0.6730 - val_pearson_correlation_f: 0.4088
Epoch 16/20
8000/8000 [==============================] - 1s 169us/step - loss: 0.3641 - acc: 0.8335 - pearson_correlation_f: 0.7602 - val_loss: 0.7145 - val_acc: 0.6600 - val_pearson_correlation_f: 0.4223
Epoch 17/20
8000/8000 [==============================] - 1s 170us/step - loss: 0.3347 - acc: 0.8482 - pearson_correlation_f: 0.7853 - val_loss: 0.6378 - val_acc: 0.6780 - val_pearson_correlation_f: 0.4499
Epoch 18/20
8000/8000 [==============================] - 1s 168us/step - loss: 0.3059 - acc: 0.8686 - pearson_correlation_f: 0.8105 - val_loss: 0.6511 - val_acc: 0.6740 - val_pearson_correlation_f: 0.4360
Epoch 19/20
8000/8000 [==============================] - 1s 168us/step - loss: 0.2763 - acc: 0.8870 - pearson_correlation_f: 0.8355 - val_loss: 0.7057 - val_acc: 0.6780 - val_pearson_correlation_f: 0.4509
Epoch 20/20
8000/8000 [==============================] - 1s 168us/step - loss: 0.2577 - acc: 0.8922 - pearson_correlation_f: 0.8479 - val_loss: 0.6900 - val_acc: 0.6770 - val_pearson_correlation_f: 0.4482
1000/1000 [==============================] - 0s 350us/step
Test result:  [0.7057728462219238, 0.689, 0.44380963158607484]
SETTING: neg InferSent 5000 1 CNN
RESULT: 0.689


In [3]: run_all_exp(['neg'], ['glove', 'USE', 'USE-Large', 'InferSent'],
   ...:             [5000], [1], ['FC'])
Setting:  neg glove 5000 1 FC None
loading data ..
merging data ..
creating tokenizer ..
padding ..
shuffling ..
splitting ..
train:  (8000, 640) (8000,)
val:  (1000, 640) (1000,)
test:  (1000, 640) (1000,)
building model ..
Indexing word vectors.
Found 400000 word vectors.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 640)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 640, 100)          6643000   
_________________________________________________________________
flatten_1 (Flatten)          (None, 64000)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               8192128   
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 14,835,257
Trainable params: 8,192,257
Non-trainable params: 6,643,000
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
2018-12-07 01:06:41.879885: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-07 01:06:41.976453: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-07 01:06:41.976950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.21GiB
2018-12-07 01:06:41.976968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-07 01:06:42.819913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-07 01:06:42.819950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-07 01:06:42.819961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-07 01:06:42.820123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1902 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
8000/8000 [==============================] - 2s 268us/step - loss: 0.7223 - acc: 0.4794 - pearson_correlation_f: -0.0665 - val_loss: 0.6935 - val_acc: 0.5060 - val_pearson_correlation_f: 0.0259
Epoch 2/20
8000/8000 [==============================] - 0s 56us/step - loss: 0.7087 - acc: 0.4988 - pearson_correlation_f: -0.0289 - val_loss: 0.6934 - val_acc: 0.4960 - val_pearson_correlation_f: -0.0288
Epoch 3/20
8000/8000 [==============================] - 0s 55us/step - loss: 0.8057 - acc: 0.4988 - pearson_correlation_f: nan - val_loss: 0.6931 - val_acc: 0.5030 - val_pearson_correlation_f: nan
Epoch 4/20
8000/8000 [==============================] - 0s 55us/step - loss: 0.7112 - acc: 0.5036 - pearson_correlation_f: nan - val_loss: 0.6918 - val_acc: 0.5070 - val_pearson_correlation_f: 0.0591
Epoch 5/20
8000/8000 [==============================] - 0s 56us/step - loss: 0.6976 - acc: 0.5036 - pearson_correlation_f: 0.0512 - val_loss: 0.6906 - val_acc: 0.5040 - val_pearson_correlation_f: 0.0730
Epoch 6/20
8000/8000 [==============================] - 0s 56us/step - loss: 0.6877 - acc: 0.5154 - pearson_correlation_f: 0.1214 - val_loss: 0.7100 - val_acc: 0.5040 - val_pearson_correlation_f: 0.0690
Epoch 7/20
8000/8000 [==============================] - 0s 56us/step - loss: 0.6807 - acc: 0.5235 - pearson_correlation_f: 0.1604 - val_loss: 0.6860 - val_acc: 0.5170 - val_pearson_correlation_f: 0.1208
Epoch 8/20
8000/8000 [==============================] - 0s 56us/step - loss: 0.6645 - acc: 0.5386 - pearson_correlation_f: 0.2277 - val_loss: 0.6833 - val_acc: 0.5220 - val_pearson_correlation_f: 0.1388
Epoch 9/20
8000/8000 [==============================] - 0s 55us/step - loss: 0.6490 - acc: 0.5489 - pearson_correlation_f: 0.2780 - val_loss: 0.6818 - val_acc: 0.5200 - val_pearson_correlation_f: 0.1465
Epoch 10/20
8000/8000 [==============================] - 0s 55us/step - loss: 0.6387 - acc: 0.5545 - pearson_correlation_f: 0.3045 - val_loss: 0.6855 - val_acc: 0.5200 - val_pearson_correlation_f: 0.1337
Epoch 11/20
8000/8000 [==============================] - 0s 55us/step - loss: 0.6261 - acc: 0.5650 - pearson_correlation_f: 0.3315 - val_loss: 0.7079 - val_acc: 0.5160 - val_pearson_correlation_f: 0.1294
Epoch 12/20
8000/8000 [==============================] - 0s 56us/step - loss: 0.6123 - acc: 0.5786 - pearson_correlation_f: 0.3637 - val_loss: 0.7076 - val_acc: 0.5390 - val_pearson_correlation_f: 0.1280
Epoch 13/20
8000/8000 [==============================] - 0s 56us/step - loss: 0.5942 - acc: 0.6274 - pearson_correlation_f: 0.4064 - val_loss: 0.7543 - val_acc: 0.5490 - val_pearson_correlation_f: 0.1294
Epoch 14/20
8000/8000 [==============================] - 0s 56us/step - loss: 0.5767 - acc: 0.6446 - pearson_correlation_f: 0.4402 - val_loss: 0.7396 - val_acc: 0.5730 - val_pearson_correlation_f: 0.2067
Epoch 15/20
8000/8000 [==============================] - 0s 55us/step - loss: 0.5603 - acc: 0.6601 - pearson_correlation_f: 0.4745 - val_loss: 0.7404 - val_acc: 0.5800 - val_pearson_correlation_f: 0.2048
Epoch 16/20
8000/8000 [==============================] - 0s 55us/step - loss: 0.5415 - acc: 0.6765 - pearson_correlation_f: 0.5017 - val_loss: 0.7597 - val_acc: 0.5650 - val_pearson_correlation_f: 0.1871
Epoch 17/20
8000/8000 [==============================] - 0s 55us/step - loss: 0.5256 - acc: 0.6851 - pearson_correlation_f: 0.5271 - val_loss: 0.9496 - val_acc: 0.5250 - val_pearson_correlation_f: 0.0796
Epoch 18/20
8000/8000 [==============================] - 0s 55us/step - loss: 0.5025 - acc: 0.7039 - pearson_correlation_f: 0.5573 - val_loss: 0.7796 - val_acc: 0.5780 - val_pearson_correlation_f: 0.1926
Epoch 19/20
8000/8000 [==============================] - 0s 54us/step - loss: 0.4943 - acc: 0.7103 - pearson_correlation_f: 0.5684 - val_loss: 0.8306 - val_acc: 0.5690 - val_pearson_correlation_f: 0.1803
Epoch 20/20
8000/8000 [==============================] - 0s 55us/step - loss: 0.4703 - acc: 0.7259 - pearson_correlation_f: 0.5967 - val_loss: 0.8542 - val_acc: 0.5660 - val_pearson_correlation_f: 0.1634
1000/1000 [==============================] - 0s 49us/step
Test result:  [0.8514764471054077, 0.551, 0.14822560471296312]
SETTING: neg glove 5000 1 FC
RESULT: 0.551
Setting:  neg USE 5000 1 FC None
loading data ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (8000, 13, 512) (8000,)
val:  (1000, 13, 512) (1000,)
test:  (1000, 13, 512) (1000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 6656)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 128)               852096    
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 129       
=================================================================
Total params: 852,225
Trainable params: 852,225
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
8000/8000 [==============================] - 0s 62us/step - loss: 0.6934 - acc: 0.5001 - pearson_correlation_f: -0.0030 - val_loss: 0.6932 - val_acc: 0.5130 - val_pearson_correlation_f: 0.0077
Epoch 2/20
8000/8000 [==============================] - 0s 37us/step - loss: 0.6930 - acc: 0.5048 - pearson_correlation_f: 0.0256 - val_loss: 0.6897 - val_acc: 0.5630 - val_pearson_correlation_f: 0.1482
Epoch 3/20
8000/8000 [==============================] - 0s 37us/step - loss: 0.6862 - acc: 0.5356 - pearson_correlation_f: 0.1462 - val_loss: 0.6684 - val_acc: 0.6060 - val_pearson_correlation_f: 0.2697
Epoch 4/20
8000/8000 [==============================] - 0s 37us/step - loss: 0.6502 - acc: 0.6096 - pearson_correlation_f: 0.3242 - val_loss: 0.6273 - val_acc: 0.6480 - val_pearson_correlation_f: 0.3843
Epoch 5/20
8000/8000 [==============================] - 0s 37us/step - loss: 0.5881 - acc: 0.6955 - pearson_correlation_f: 0.4916 - val_loss: 0.5931 - val_acc: 0.6800 - val_pearson_correlation_f: 0.4696
Epoch 6/20
8000/8000 [==============================] - 0s 37us/step - loss: 0.5240 - acc: 0.7595 - pearson_correlation_f: 0.5991 - val_loss: 0.5532 - val_acc: 0.7160 - val_pearson_correlation_f: 0.5118
Epoch 7/20
8000/8000 [==============================] - 0s 38us/step - loss: 0.4669 - acc: 0.8007 - pearson_correlation_f: 0.6763 - val_loss: 0.5350 - val_acc: 0.7330 - val_pearson_correlation_f: 0.5378
Epoch 8/20
8000/8000 [==============================] - 0s 38us/step - loss: 0.4108 - acc: 0.8359 - pearson_correlation_f: 0.7357 - val_loss: 0.5578 - val_acc: 0.7210 - val_pearson_correlation_f: 0.5535
Epoch 9/20
8000/8000 [==============================] - 0s 37us/step - loss: 0.3637 - acc: 0.8649 - pearson_correlation_f: 0.7791 - val_loss: 0.5155 - val_acc: 0.7410 - val_pearson_correlation_f: 0.5917
Epoch 10/20
8000/8000 [==============================] - 0s 38us/step - loss: 0.3227 - acc: 0.8859 - pearson_correlation_f: 0.8186 - val_loss: 0.5106 - val_acc: 0.7420 - val_pearson_correlation_f: 0.6014
Epoch 11/20
8000/8000 [==============================] - 0s 37us/step - loss: 0.2836 - acc: 0.9074 - pearson_correlation_f: 0.8482 - val_loss: 0.4785 - val_acc: 0.7830 - val_pearson_correlation_f: 0.6214
Epoch 12/20
8000/8000 [==============================] - 0s 38us/step - loss: 0.2523 - acc: 0.9239 - pearson_correlation_f: 0.8733 - val_loss: 0.4742 - val_acc: 0.7760 - val_pearson_correlation_f: 0.6268
Epoch 13/20
8000/8000 [==============================] - 0s 38us/step - loss: 0.2223 - acc: 0.9357 - pearson_correlation_f: 0.8934 - val_loss: 0.4842 - val_acc: 0.7750 - val_pearson_correlation_f: 0.6227
Epoch 14/20
8000/8000 [==============================] - 0s 38us/step - loss: 0.1912 - acc: 0.9493 - pearson_correlation_f: 0.9141 - val_loss: 0.5451 - val_acc: 0.7730 - val_pearson_correlation_f: 0.6265
Epoch 15/20
8000/8000 [==============================] - 0s 38us/step - loss: 0.1707 - acc: 0.9551 - pearson_correlation_f: 0.9262 - val_loss: 0.4935 - val_acc: 0.7750 - val_pearson_correlation_f: 0.6302
Epoch 16/20
8000/8000 [==============================] - 0s 38us/step - loss: 0.1470 - acc: 0.9639 - pearson_correlation_f: 0.9378 - val_loss: 0.4913 - val_acc: 0.7910 - val_pearson_correlation_f: 0.6388
Epoch 17/20
8000/8000 [==============================] - 0s 38us/step - loss: 0.1272 - acc: 0.9715 - pearson_correlation_f: 0.9491 - val_loss: 0.5552 - val_acc: 0.7590 - val_pearson_correlation_f: 0.6131
Epoch 18/20
8000/8000 [==============================] - 0s 39us/step - loss: 0.1081 - acc: 0.9791 - pearson_correlation_f: 0.9595 - val_loss: 0.5193 - val_acc: 0.7930 - val_pearson_correlation_f: 0.6416
Epoch 19/20
8000/8000 [==============================] - 0s 39us/step - loss: 0.1002 - acc: 0.9789 - pearson_correlation_f: 0.9625 - val_loss: 0.5340 - val_acc: 0.8050 - val_pearson_correlation_f: 0.6418
Epoch 20/20
8000/8000 [==============================] - 0s 38us/step - loss: 0.0822 - acc: 0.9850 - pearson_correlation_f: 0.9714 - val_loss: 0.5676 - val_acc: 0.7730 - val_pearson_correlation_f: 0.6206
1000/1000 [==============================] - 0s 47us/step
Test result:  [0.5413730342388153, 0.803, 0.6550408978462219]
SETTING: neg USE 5000 1 FC
RESULT: 0.803
Setting:  neg USE-Large 5000 1 FC None
loading data ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (8000, 13, 512) (8000,)
val:  (1000, 13, 512) (1000,)
test:  (1000, 13, 512) (1000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6656)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 128)               852096    
_________________________________________________________________
dense_6 (Dense)              (None, 1)                 129       
=================================================================
Total params: 852,225
Trainable params: 852,225
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
8000/8000 [==============================] - 1s 71us/step - loss: 0.6936 - acc: 0.4939 - pearson_correlation_f: -0.0099 - val_loss: 0.6936 - val_acc: 0.4990 - val_pearson_correlation_f: -0.0074
Epoch 2/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.6940 - acc: 0.4901 - pearson_correlation_f: -0.0186 - val_loss: 0.6918 - val_acc: 0.5150 - val_pearson_correlation_f: 0.0830
Epoch 3/20
8000/8000 [==============================] - 0s 35us/step - loss: 0.6876 - acc: 0.5464 - pearson_correlation_f: 0.1632 - val_loss: 0.6565 - val_acc: 0.6960 - val_pearson_correlation_f: 0.5190
Epoch 4/20
8000/8000 [==============================] - 0s 36us/step - loss: 0.6106 - acc: 0.7185 - pearson_correlation_f: 0.5285 - val_loss: 0.5442 - val_acc: 0.8020 - val_pearson_correlation_f: 0.6320
Epoch 5/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.4900 - acc: 0.8216 - pearson_correlation_f: 0.6889 - val_loss: 0.4773 - val_acc: 0.8050 - val_pearson_correlation_f: 0.7066
Epoch 6/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.3954 - acc: 0.8646 - pearson_correlation_f: 0.7700 - val_loss: 0.3923 - val_acc: 0.8650 - val_pearson_correlation_f: 0.7468
Epoch 7/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.3196 - acc: 0.8981 - pearson_correlation_f: 0.8234 - val_loss: 0.3708 - val_acc: 0.8530 - val_pearson_correlation_f: 0.7499
Epoch 8/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.2636 - acc: 0.9231 - pearson_correlation_f: 0.8633 - val_loss: 0.3425 - val_acc: 0.8720 - val_pearson_correlation_f: 0.7745
Epoch 9/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.2180 - acc: 0.9380 - pearson_correlation_f: 0.8922 - val_loss: 0.3356 - val_acc: 0.8610 - val_pearson_correlation_f: 0.7766
Epoch 10/20
8000/8000 [==============================] - 0s 35us/step - loss: 0.1787 - acc: 0.9500 - pearson_correlation_f: 0.9153 - val_loss: 0.3577 - val_acc: 0.8510 - val_pearson_correlation_f: 0.7668
Epoch 11/20
8000/8000 [==============================] - 0s 33us/step - loss: 0.1515 - acc: 0.9625 - pearson_correlation_f: 0.9319 - val_loss: 0.3227 - val_acc: 0.8750 - val_pearson_correlation_f: 0.7861
Epoch 12/20
8000/8000 [==============================] - 0s 35us/step - loss: 0.1258 - acc: 0.9681 - pearson_correlation_f: 0.9456 - val_loss: 0.3266 - val_acc: 0.8660 - val_pearson_correlation_f: 0.7892
Epoch 13/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.1028 - acc: 0.9774 - pearson_correlation_f: 0.9583 - val_loss: 0.3236 - val_acc: 0.8720 - val_pearson_correlation_f: 0.7893
Epoch 14/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.0864 - acc: 0.9824 - pearson_correlation_f: 0.9665 - val_loss: 0.3366 - val_acc: 0.8760 - val_pearson_correlation_f: 0.7943
Epoch 15/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.0701 - acc: 0.9875 - pearson_correlation_f: 0.9742 - val_loss: 0.3761 - val_acc: 0.8570 - val_pearson_correlation_f: 0.7789
Epoch 16/20
8000/8000 [==============================] - 0s 36us/step - loss: 0.0613 - acc: 0.9890 - pearson_correlation_f: 0.9775 - val_loss: 0.3321 - val_acc: 0.8770 - val_pearson_correlation_f: 0.7960
Epoch 17/20
8000/8000 [==============================] - 0s 35us/step - loss: 0.0478 - acc: 0.9924 - pearson_correlation_f: 0.9839 - val_loss: 0.3649 - val_acc: 0.8680 - val_pearson_correlation_f: 0.7894
Epoch 18/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.0426 - acc: 0.9926 - pearson_correlation_f: 0.9856 - val_loss: 0.3346 - val_acc: 0.8820 - val_pearson_correlation_f: 0.8026
Epoch 19/20
8000/8000 [==============================] - 0s 35us/step - loss: 0.0355 - acc: 0.9939 - pearson_correlation_f: 0.9881 - val_loss: 0.3500 - val_acc: 0.8770 - val_pearson_correlation_f: 0.8016
Epoch 20/20
8000/8000 [==============================] - 0s 34us/step - loss: 0.0321 - acc: 0.9948 - pearson_correlation_f: 0.9892 - val_loss: 0.3471 - val_acc: 0.8820 - val_pearson_correlation_f: 0.8026
1000/1000 [==============================] - 0s 44us/step
Test result:  [0.3732616019248962, 0.892, 0.8144330492019654]
SETTING: neg USE-Large 5000 1 FC
RESULT: 0.892
Setting:  neg InferSent 5000 1 FC None
loading data ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (8000, 13, 4096) (8000,)
val:  (1000, 13, 4096) (1000,)
test:  (1000, 13, 4096) (1000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 13, 4096)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 53248)             0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               6815872   
_________________________________________________________________
dense_8 (Dense)              (None, 1)                 129       
=================================================================
Total params: 6,816,001
Trainable params: 6,816,001
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
8000/8000 [==============================] - 3s 339us/step - loss: 0.6934 - acc: 0.5029 - pearson_correlation_f: 0.0075 - val_loss: 0.6916 - val_acc: 0.5320 - val_pearson_correlation_f: 0.0845
Epoch 2/20
8000/8000 [==============================] - 1s 123us/step - loss: 0.6929 - acc: 0.5181 - pearson_correlation_f: 0.0588 - val_loss: 0.6928 - val_acc: 0.5220 - val_pearson_correlation_f: 0.1432
Epoch 3/20
8000/8000 [==============================] - 1s 121us/step - loss: 0.6932 - acc: 0.5170 - pearson_correlation_f: 0.0861 - val_loss: 0.6840 - val_acc: 0.5420 - val_pearson_correlation_f: 0.1688
Epoch 4/20
8000/8000 [==============================] - 1s 125us/step - loss: 0.6872 - acc: 0.5304 - pearson_correlation_f: 0.1392 - val_loss: 0.6969 - val_acc: 0.5240 - val_pearson_correlation_f: 0.1536
Epoch 5/20
8000/8000 [==============================] - 1s 129us/step - loss: 0.6613 - acc: 0.5620 - pearson_correlation_f: 0.2509 - val_loss: 0.6666 - val_acc: 0.5630 - val_pearson_correlation_f: 0.2289
Epoch 6/20
8000/8000 [==============================] - 1s 123us/step - loss: 0.6328 - acc: 0.5971 - pearson_correlation_f: 0.3385 - val_loss: 0.6618 - val_acc: 0.5780 - val_pearson_correlation_f: 0.2644
Epoch 7/20
8000/8000 [==============================] - 1s 123us/step - loss: 0.6024 - acc: 0.6218 - pearson_correlation_f: 0.4138 - val_loss: 0.6341 - val_acc: 0.6050 - val_pearson_correlation_f: 0.3258
Epoch 8/20
8000/8000 [==============================] - 1s 123us/step - loss: 0.5746 - acc: 0.6475 - pearson_correlation_f: 0.4666 - val_loss: 0.6388 - val_acc: 0.6370 - val_pearson_correlation_f: 0.3422
Epoch 9/20
8000/8000 [==============================] - 1s 122us/step - loss: 0.5478 - acc: 0.6704 - pearson_correlation_f: 0.5053 - val_loss: 0.6754 - val_acc: 0.6020 - val_pearson_correlation_f: 0.3087
Epoch 10/20
8000/8000 [==============================] - 1s 123us/step - loss: 0.5213 - acc: 0.6871 - pearson_correlation_f: 0.5476 - val_loss: 0.6211 - val_acc: 0.6100 - val_pearson_correlation_f: 0.3626
Epoch 11/20
8000/8000 [==============================] - 1s 123us/step - loss: 0.4930 - acc: 0.7193 - pearson_correlation_f: 0.5862 - val_loss: 0.6364 - val_acc: 0.6340 - val_pearson_correlation_f: 0.3616
Epoch 12/20
8000/8000 [==============================] - 1s 123us/step - loss: 0.4699 - acc: 0.7340 - pearson_correlation_f: 0.6180 - val_loss: 0.6523 - val_acc: 0.6450 - val_pearson_correlation_f: 0.3598
Epoch 13/20
8000/8000 [==============================] - 1s 124us/step - loss: 0.4455 - acc: 0.7604 - pearson_correlation_f: 0.6488 - val_loss: 0.6227 - val_acc: 0.6580 - val_pearson_correlation_f: 0.4040
Epoch 14/20
8000/8000 [==============================] - 1s 126us/step - loss: 0.4194 - acc: 0.7846 - pearson_correlation_f: 0.6778 - val_loss: 0.6622 - val_acc: 0.6460 - val_pearson_correlation_f: 0.3875
Epoch 15/20
8000/8000 [==============================] - 1s 122us/step - loss: 0.3895 - acc: 0.8086 - pearson_correlation_f: 0.7112 - val_loss: 0.6602 - val_acc: 0.6530 - val_pearson_correlation_f: 0.3894
Epoch 16/20
8000/8000 [==============================] - 1s 122us/step - loss: 0.3686 - acc: 0.8254 - pearson_correlation_f: 0.7353 - val_loss: 0.6325 - val_acc: 0.6630 - val_pearson_correlation_f: 0.4285
Epoch 17/20
8000/8000 [==============================] - 1s 132us/step - loss: 0.3434 - acc: 0.8434 - pearson_correlation_f: 0.7605 - val_loss: 0.7448 - val_acc: 0.6610 - val_pearson_correlation_f: 0.4315
Epoch 18/20
8000/8000 [==============================] - 1s 118us/step - loss: 0.3274 - acc: 0.8559 - pearson_correlation_f: 0.7791 - val_loss: 0.6875 - val_acc: 0.6710 - val_pearson_correlation_f: 0.4307
Epoch 19/20
8000/8000 [==============================] - 1s 124us/step - loss: 0.2995 - acc: 0.8722 - pearson_correlation_f: 0.8047 - val_loss: 0.6653 - val_acc: 0.6920 - val_pearson_correlation_f: 0.4576
Epoch 20/20
8000/8000 [==============================] - 1s 121us/step - loss: 0.2764 - acc: 0.8825 - pearson_correlation_f: 0.8233 - val_loss: 0.6517 - val_acc: 0.7040 - val_pearson_correlation_f: 0.4685
1000/1000 [==============================] - 0s 141us/step
Test result:  [0.6839074153900147, 0.677, 0.42295871567726134]
SETTING: neg InferSent 5000 1 FC
RESULT: 0.677

In [4]: run_all_exp(['neg'], ['glove', 'USE', 'USE-Large', 'InferSent'],
   ...:             [5000], [1], ['LSTM'])
Setting:  neg glove 5000 1 LSTM None
loading data ..
merging data ..
creating tokenizer ..
padding ..
shuffling ..
splitting ..
train:  (8000, 640) (8000,)
val:  (1000, 640) (1000,)
test:  (1000, 640) (1000,)
building model ..
Indexing word vectors.
Found 400000 word vectors.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 640)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 640, 100)          6626900   
_________________________________________________________________
lstm_1 (LSTM)                (None, 128)               117248    
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 129       
=================================================================
Total params: 6,744,277
Trainable params: 117,377
Non-trainable params: 6,626,900
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
2018-12-07 01:10:16.372079: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-07 01:10:16.468128: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-07 01:10:16.468607: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.21GiB
2018-12-07 01:10:16.468626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-07 01:10:17.285871: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-07 01:10:17.285905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-07 01:10:17.285912: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-07 01:10:17.286070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 1902 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
8000/8000 [==============================] - 43s 5ms/step - loss: 0.6932 - acc: 0.4959 - pearson_correlation_f: 0.0107 - val_loss: 0.6931 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0217
Epoch 2/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6933 - acc: 0.4960 - pearson_correlation_f: -0.0130 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0229
Epoch 3/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6933 - acc: 0.4960 - pearson_correlation_f: -0.0047 - val_loss: 0.6931 - val_acc: 0.5000 - val_pearson_correlation_f: nan
Epoch 4/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6931 - acc: 0.5078 - pearson_correlation_f: 0.0249 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0152
Epoch 5/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6936 - acc: 0.4854 - pearson_correlation_f: -0.0223 - val_loss: 0.6931 - val_acc: 0.5000 - val_pearson_correlation_f: nan
Epoch 6/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6933 - acc: 0.4995 - pearson_correlation_f: 0.0059 - val_loss: 0.6931 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0331
Epoch 7/20
8000/8000 [==============================] - 42s 5ms/step - loss: 0.6932 - acc: 0.5056 - pearson_correlation_f: 0.0125 - val_loss: 0.6933 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0097
Epoch 8/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6933 - acc: 0.5036 - pearson_correlation_f: 0.0109 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0169
Epoch 9/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6933 - acc: 0.5002 - pearson_correlation_f: 0.0081 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0050
Epoch 10/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6932 - acc: 0.5048 - pearson_correlation_f: 0.0168 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0105
Epoch 11/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6933 - acc: 0.5081 - pearson_correlation_f: 0.0073 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0167
Epoch 12/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6933 - acc: 0.4993 - pearson_correlation_f: 0.0063 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0179
Epoch 13/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6934 - acc: 0.4945 - pearson_correlation_f: -0.0028 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -6.7768e-04
Epoch 14/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6933 - acc: 0.5016 - pearson_correlation_f: 0.0018 - val_loss: 0.6934 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0029
Epoch 15/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6934 - acc: 0.4946 - pearson_correlation_f: -1.1179e-04 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: nan
Epoch 16/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6932 - acc: 0.5067 - pearson_correlation_f: 0.0162 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0047
Epoch 17/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6934 - acc: 0.4940 - pearson_correlation_f: -3.6158e-04 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0156
Epoch 18/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6933 - acc: 0.5032 - pearson_correlation_f: 0.0081 - val_loss: 0.6931 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0056
Epoch 19/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6934 - acc: 0.4963 - pearson_correlation_f: 0.0039 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0126
Epoch 20/20
8000/8000 [==============================] - 41s 5ms/step - loss: 0.6934 - acc: 0.4940 - pearson_correlation_f: -0.0084 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0111
1000/1000 [==============================] - 7s 7ms/step
Test result:  [0.6931548385620118, 0.5, -0.0015542343854904174]
SETTING: neg glove 5000 1 LSTM
RESULT: 0.5
Setting:  neg USE 5000 1 LSTM None
loading data ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (8000, 13, 512) (8000,)
val:  (1000, 13, 512) (1000,)
test:  (1000, 13, 512) (1000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128)               328192    
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 328,321
Trainable params: 328,321
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
8000/8000 [==============================] - 2s 282us/step - loss: 0.6933 - acc: 0.5000 - pearson_correlation_f: -5.8864e-04 - val_loss: 0.6931 - val_acc: 0.4920 - val_pearson_correlation_f: 0.0054
Epoch 2/20
8000/8000 [==============================] - 1s 186us/step - loss: 0.6934 - acc: 0.4964 - pearson_correlation_f: -0.0050 - val_loss: 0.6930 - val_acc: 0.4920 - val_pearson_correlation_f: 0.0413
Epoch 3/20
8000/8000 [==============================] - 1s 186us/step - loss: 0.6922 - acc: 0.5079 - pearson_correlation_f: 0.0609 - val_loss: 0.6903 - val_acc: 0.5240 - val_pearson_correlation_f: 0.1269
Epoch 4/20
8000/8000 [==============================] - 1s 187us/step - loss: 0.6866 - acc: 0.5524 - pearson_correlation_f: 0.1562 - val_loss: 0.6861 - val_acc: 0.5310 - val_pearson_correlation_f: 0.1621
Epoch 5/20
8000/8000 [==============================] - 1s 184us/step - loss: 0.6782 - acc: 0.5704 - pearson_correlation_f: 0.2137 - val_loss: 0.6769 - val_acc: 0.5750 - val_pearson_correlation_f: 0.2015
Epoch 6/20
8000/8000 [==============================] - 2s 189us/step - loss: 0.6667 - acc: 0.5856 - pearson_correlation_f: 0.2491 - val_loss: 0.6719 - val_acc: 0.5790 - val_pearson_correlation_f: 0.2287
Epoch 7/20
8000/8000 [==============================] - 1s 186us/step - loss: 0.6547 - acc: 0.6095 - pearson_correlation_f: 0.2837 - val_loss: 0.6564 - val_acc: 0.5980 - val_pearson_correlation_f: 0.2707
Epoch 8/20
8000/8000 [==============================] - 2s 189us/step - loss: 0.6394 - acc: 0.6214 - pearson_correlation_f: 0.3303 - val_loss: 0.6408 - val_acc: 0.6230 - val_pearson_correlation_f: 0.3272
Epoch 9/20
8000/8000 [==============================] - 2s 189us/step - loss: 0.6228 - acc: 0.6394 - pearson_correlation_f: 0.3722 - val_loss: 0.6205 - val_acc: 0.6520 - val_pearson_correlation_f: 0.3833
Epoch 10/20
8000/8000 [==============================] - 1s 186us/step - loss: 0.6004 - acc: 0.6691 - pearson_correlation_f: 0.4200 - val_loss: 0.5972 - val_acc: 0.6800 - val_pearson_correlation_f: 0.4328
Epoch 11/20
8000/8000 [==============================] - 1s 186us/step - loss: 0.5777 - acc: 0.6895 - pearson_correlation_f: 0.4655 - val_loss: 0.5830 - val_acc: 0.6840 - val_pearson_correlation_f: 0.4537
Epoch 12/20
8000/8000 [==============================] - 2s 188us/step - loss: 0.5553 - acc: 0.7071 - pearson_correlation_f: 0.5061 - val_loss: 0.5595 - val_acc: 0.7080 - val_pearson_correlation_f: 0.4947
Epoch 13/20
8000/8000 [==============================] - 1s 182us/step - loss: 0.5290 - acc: 0.7360 - pearson_correlation_f: 0.5477 - val_loss: 0.5456 - val_acc: 0.7330 - val_pearson_correlation_f: 0.5195
Epoch 14/20
8000/8000 [==============================] - 2s 188us/step - loss: 0.5074 - acc: 0.7489 - pearson_correlation_f: 0.5798 - val_loss: 0.5345 - val_acc: 0.7340 - val_pearson_correlation_f: 0.5392
Epoch 15/20
8000/8000 [==============================] - 1s 183us/step - loss: 0.4872 - acc: 0.7578 - pearson_correlation_f: 0.6016 - val_loss: 0.5133 - val_acc: 0.7500 - val_pearson_correlation_f: 0.5698
Epoch 16/20
8000/8000 [==============================] - 1s 184us/step - loss: 0.4721 - acc: 0.7700 - pearson_correlation_f: 0.6226 - val_loss: 0.5026 - val_acc: 0.7640 - val_pearson_correlation_f: 0.5929
Epoch 17/20
8000/8000 [==============================] - 1s 186us/step - loss: 0.4484 - acc: 0.7860 - pearson_correlation_f: 0.6521 - val_loss: 0.5709 - val_acc: 0.7200 - val_pearson_correlation_f: 0.5561
Epoch 18/20
8000/8000 [==============================] - 1s 186us/step - loss: 0.4285 - acc: 0.7949 - pearson_correlation_f: 0.6741 - val_loss: 0.4824 - val_acc: 0.7710 - val_pearson_correlation_f: 0.6231
Epoch 19/20
8000/8000 [==============================] - 1s 186us/step - loss: 0.4099 - acc: 0.8067 - pearson_correlation_f: 0.6925 - val_loss: 0.5049 - val_acc: 0.7490 - val_pearson_correlation_f: 0.6030
Epoch 20/20
8000/8000 [==============================] - 1s 186us/step - loss: 0.3973 - acc: 0.8146 - pearson_correlation_f: 0.7070 - val_loss: 0.5052 - val_acc: 0.7630 - val_pearson_correlation_f: 0.6154
1000/1000 [==============================] - 0s 236us/step
Test result:  [0.48370287609100343, 0.781, 0.6336028308868408]
SETTING: neg USE 5000 1 LSTM
RESULT: 0.781
Setting:  neg USE-Large 5000 1 LSTM None
loading data ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (8000, 13, 512) (8000,)
val:  (1000, 13, 512) (1000,)
test:  (1000, 13, 512) (1000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128)               328192    
_________________________________________________________________
dropout_3 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 1)                 129       
=================================================================
Total params: 328,321
Trainable params: 328,321
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
8000/8000 [==============================] - 2s 292us/step - loss: 0.6935 - acc: 0.4856 - pearson_correlation_f: -0.0148 - val_loss: 0.6930 - val_acc: 0.4920 - val_pearson_correlation_f: 0.0225
Epoch 2/20
8000/8000 [==============================] - 1s 181us/step - loss: 0.6933 - acc: 0.4980 - pearson_correlation_f: 0.0076 - val_loss: 0.6931 - val_acc: 0.5040 - val_pearson_correlation_f: 0.0261
Epoch 3/20
8000/8000 [==============================] - 1s 184us/step - loss: 0.6942 - acc: 0.4885 - pearson_correlation_f: -0.0186 - val_loss: 0.6931 - val_acc: 0.5080 - val_pearson_correlation_f: 0.0221
Epoch 4/20
8000/8000 [==============================] - 1s 181us/step - loss: 0.6937 - acc: 0.4970 - pearson_correlation_f: 0.0120 - val_loss: 0.6928 - val_acc: 0.5060 - val_pearson_correlation_f: 0.0237
Epoch 5/20
8000/8000 [==============================] - 1s 181us/step - loss: 0.6931 - acc: 0.5030 - pearson_correlation_f: 0.0315 - val_loss: 0.6928 - val_acc: 0.5110 - val_pearson_correlation_f: 0.0240
Epoch 6/20
8000/8000 [==============================] - 1s 181us/step - loss: 0.6925 - acc: 0.5085 - pearson_correlation_f: 0.0497 - val_loss: 0.6933 - val_acc: 0.5070 - val_pearson_correlation_f: 0.0249
Epoch 7/20
8000/8000 [==============================] - 1s 184us/step - loss: 0.6918 - acc: 0.5110 - pearson_correlation_f: 0.0550 - val_loss: 0.6925 - val_acc: 0.5200 - val_pearson_correlation_f: 0.0336
Epoch 8/20
8000/8000 [==============================] - 1s 180us/step - loss: 0.6910 - acc: 0.5221 - pearson_correlation_f: 0.0778 - val_loss: 0.6912 - val_acc: 0.5310 - val_pearson_correlation_f: 0.0731
Epoch 9/20
8000/8000 [==============================] - 1s 179us/step - loss: 0.6872 - acc: 0.5414 - pearson_correlation_f: 0.1251 - val_loss: 0.6868 - val_acc: 0.5400 - val_pearson_correlation_f: 0.1209
Epoch 10/20
8000/8000 [==============================] - 1s 182us/step - loss: 0.6796 - acc: 0.5685 - pearson_correlation_f: 0.1797 - val_loss: 0.6724 - val_acc: 0.5880 - val_pearson_correlation_f: 0.2429
Epoch 11/20
8000/8000 [==============================] - 1s 179us/step - loss: 0.6569 - acc: 0.6009 - pearson_correlation_f: 0.2849 - val_loss: 0.6335 - val_acc: 0.6250 - val_pearson_correlation_f: 0.3705
Epoch 12/20
8000/8000 [==============================] - 1s 184us/step - loss: 0.6178 - acc: 0.6496 - pearson_correlation_f: 0.3830 - val_loss: 0.5972 - val_acc: 0.6770 - val_pearson_correlation_f: 0.4355
Epoch 13/20
8000/8000 [==============================] - 1s 178us/step - loss: 0.5835 - acc: 0.6847 - pearson_correlation_f: 0.4507 - val_loss: 0.5900 - val_acc: 0.6810 - val_pearson_correlation_f: 0.4360
Epoch 14/20
8000/8000 [==============================] - 1s 182us/step - loss: 0.5588 - acc: 0.7076 - pearson_correlation_f: 0.4942 - val_loss: 0.5490 - val_acc: 0.7060 - val_pearson_correlation_f: 0.5103
Epoch 15/20
8000/8000 [==============================] - 1s 181us/step - loss: 0.5274 - acc: 0.7334 - pearson_correlation_f: 0.5454 - val_loss: 0.5389 - val_acc: 0.7120 - val_pearson_correlation_f: 0.5361
Epoch 16/20
8000/8000 [==============================] - 1s 182us/step - loss: 0.4991 - acc: 0.7526 - pearson_correlation_f: 0.5852 - val_loss: 0.5078 - val_acc: 0.7490 - val_pearson_correlation_f: 0.5758
Epoch 17/20
8000/8000 [==============================] - 1s 181us/step - loss: 0.4687 - acc: 0.7804 - pearson_correlation_f: 0.6262 - val_loss: 0.4896 - val_acc: 0.7780 - val_pearson_correlation_f: 0.6010
Epoch 18/20
8000/8000 [==============================] - 1s 180us/step - loss: 0.4409 - acc: 0.7951 - pearson_correlation_f: 0.6577 - val_loss: 0.4775 - val_acc: 0.7710 - val_pearson_correlation_f: 0.6097
Epoch 19/20
8000/8000 [==============================] - 1s 180us/step - loss: 0.4126 - acc: 0.8157 - pearson_correlation_f: 0.6895 - val_loss: 0.4503 - val_acc: 0.8030 - val_pearson_correlation_f: 0.6474
Epoch 20/20
8000/8000 [==============================] - 1s 185us/step - loss: 0.3890 - acc: 0.8316 - pearson_correlation_f: 0.7174 - val_loss: 0.4563 - val_acc: 0.7970 - val_pearson_correlation_f: 0.6528
1000/1000 [==============================] - 0s 239us/step
Test result:  [0.4358564605712891, 0.801, 0.6740613536834716]
SETTING: neg USE-Large 5000 1 LSTM
RESULT: 0.801
Setting:  neg InferSent 5000 1 LSTM None
loading data ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (8000, 13, 4096) (8000,)
val:  (1000, 13, 4096) (1000,)
test:  (1000, 13, 4096) (1000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 13, 4096)          0         
_________________________________________________________________
lstm_4 (LSTM)                (None, 128)               2163200   
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 129       
=================================================================
Total params: 2,163,329
Trainable params: 2,163,329
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 8000 samples, validate on 1000 samples
Epoch 1/20
8000/8000 [==============================] - 6s 735us/step - loss: 0.6934 - acc: 0.5005 - pearson_correlation_f: -0.0023 - val_loss: 0.6934 - val_acc: 0.4920 - val_pearson_correlation_f: -0.0274
Epoch 2/20
8000/8000 [==============================] - 2s 280us/step - loss: 0.6934 - acc: 0.5012 - pearson_correlation_f: 0.0037 - val_loss: 0.6930 - val_acc: 0.5040 - val_pearson_correlation_f: 0.0374
Epoch 3/20
8000/8000 [==============================] - 2s 280us/step - loss: 0.6939 - acc: 0.5062 - pearson_correlation_f: 0.0398 - val_loss: 0.6935 - val_acc: 0.5180 - val_pearson_correlation_f: 0.0628
Epoch 4/20
8000/8000 [==============================] - 2s 281us/step - loss: 0.6911 - acc: 0.5226 - pearson_correlation_f: 0.0906 - val_loss: 0.6869 - val_acc: 0.5440 - val_pearson_correlation_f: 0.1307
Epoch 5/20
8000/8000 [==============================] - 2s 280us/step - loss: 0.6806 - acc: 0.5618 - pearson_correlation_f: 0.1835 - val_loss: 0.6790 - val_acc: 0.5730 - val_pearson_correlation_f: 0.2004
Epoch 6/20
8000/8000 [==============================] - 2s 282us/step - loss: 0.6643 - acc: 0.5866 - pearson_correlation_f: 0.2650 - val_loss: 0.6629 - val_acc: 0.5840 - val_pearson_correlation_f: 0.2466
Epoch 7/20
8000/8000 [==============================] - 2s 280us/step - loss: 0.6480 - acc: 0.5944 - pearson_correlation_f: 0.3216 - val_loss: 0.6518 - val_acc: 0.5730 - val_pearson_correlation_f: 0.2771
Epoch 8/20
8000/8000 [==============================] - 2s 280us/step - loss: 0.6253 - acc: 0.6266 - pearson_correlation_f: 0.3675 - val_loss: 0.6549 - val_acc: 0.5730 - val_pearson_correlation_f: 0.2884
Epoch 9/20
8000/8000 [==============================] - 2s 279us/step - loss: 0.6026 - acc: 0.6454 - pearson_correlation_f: 0.4235 - val_loss: 0.6292 - val_acc: 0.6070 - val_pearson_correlation_f: 0.3489
Epoch 10/20
8000/8000 [==============================] - 2s 280us/step - loss: 0.5683 - acc: 0.6920 - pearson_correlation_f: 0.4849 - val_loss: 0.6072 - val_acc: 0.6400 - val_pearson_correlation_f: 0.3893
Epoch 11/20
8000/8000 [==============================] - 2s 280us/step - loss: 0.5325 - acc: 0.7134 - pearson_correlation_f: 0.5437 - val_loss: 0.6544 - val_acc: 0.6450 - val_pearson_correlation_f: 0.3969
Epoch 12/20
8000/8000 [==============================] - 2s 281us/step - loss: 0.5104 - acc: 0.7325 - pearson_correlation_f: 0.5763 - val_loss: 0.6520 - val_acc: 0.6310 - val_pearson_correlation_f: 0.4107
Epoch 13/20
8000/8000 [==============================] - 2s 278us/step - loss: 0.4735 - acc: 0.7639 - pearson_correlation_f: 0.6250 - val_loss: 0.6178 - val_acc: 0.6720 - val_pearson_correlation_f: 0.4472
Epoch 14/20
8000/8000 [==============================] - 2s 281us/step - loss: 0.4428 - acc: 0.7830 - pearson_correlation_f: 0.6631 - val_loss: 0.5785 - val_acc: 0.7050 - val_pearson_correlation_f: 0.4995
Epoch 15/20
8000/8000 [==============================] - 2s 279us/step - loss: 0.4057 - acc: 0.8076 - pearson_correlation_f: 0.7004 - val_loss: 0.5922 - val_acc: 0.6880 - val_pearson_correlation_f: 0.4713
Epoch 16/20
8000/8000 [==============================] - 2s 278us/step - loss: 0.3704 - acc: 0.8315 - pearson_correlation_f: 0.7390 - val_loss: 0.5850 - val_acc: 0.7120 - val_pearson_correlation_f: 0.5100
Epoch 17/20
8000/8000 [==============================] - 2s 279us/step - loss: 0.3407 - acc: 0.8473 - pearson_correlation_f: 0.7662 - val_loss: 0.6452 - val_acc: 0.6990 - val_pearson_correlation_f: 0.4868
Epoch 18/20
8000/8000 [==============================] - 2s 282us/step - loss: 0.3096 - acc: 0.8624 - pearson_correlation_f: 0.7968 - val_loss: 0.8685 - val_acc: 0.6800 - val_pearson_correlation_f: 0.4530
Epoch 19/20
8000/8000 [==============================] - 2s 279us/step - loss: 0.2688 - acc: 0.8829 - pearson_correlation_f: 0.8264 - val_loss: 0.6238 - val_acc: 0.7360 - val_pearson_correlation_f: 0.5337
Epoch 20/20
8000/8000 [==============================] - 2s 282us/step - loss: 0.2457 - acc: 0.8974 - pearson_correlation_f: 0.8483 - val_loss: 0.7626 - val_acc: 0.7140 - val_pearson_correlation_f: 0.4922
1000/1000 [==============================] - 0s 365us/step
Test result:  [0.7213450479507446, 0.718, 0.522913390636444]
SETTING: neg InferSent 5000 1 LSTM
RESULT: 0.718
