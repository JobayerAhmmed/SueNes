python3 main.py neg glove FC
Using TensorFlow backend.
Setting:  neg glove 30000 1 FC None
loading data ..
loading pickle ..
retrieving article ..
merging data ..
creating tokenizer ..
padding ..
shuffling ..
splitting ..
train:  (48000, 640) (48000,)
val:  (6000, 640) (6000,)
test:  (6000, 640) (6000,)
building model ..
Indexing word vectors.
Found 400000 word vectors.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 640)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 640, 100)          14409500  
_________________________________________________________________
flatten_1 (Flatten)          (None, 64000)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               8192128   
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 22,601,757
Trainable params: 8,192,257
Non-trainable params: 14,409,500
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/20
2018-12-08 02:43:04.636382: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-08 02:43:04.728203: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-08 02:43:04.728643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.75GiB
2018-12-08 02:43:04.728659: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-08 02:43:04.884724: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-08 02:43:04.884760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-08 02:43:04.884766: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-08 02:43:04.884906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2450 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
48000/48000 [==============================] - 4s 76us/step - loss: 0.7623 - acc: 0.5080 - pearson_correlation_f: 0.0437 - val_loss: 0.6934 - val_acc: 0.4973 - val_pearson_correlation_f: 0.0931
Epoch 2/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.6847 - acc: 0.5392 - pearson_correlation_f: 0.1695 - val_loss: 0.6694 - val_acc: 0.5533 - val_pearson_correlation_f: 0.2124
Epoch 3/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.6514 - acc: 0.5754 - pearson_correlation_f: 0.2800 - val_loss: 0.6447 - val_acc: 0.5783 - val_pearson_correlation_f: 0.2900
Epoch 4/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.6161 - acc: 0.6105 - pearson_correlation_f: 0.3676 - val_loss: 0.6056 - val_acc: 0.6377 - val_pearson_correlation_f: 0.3907
Epoch 5/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.5630 - acc: 0.6714 - pearson_correlation_f: 0.4712 - val_loss: 0.5519 - val_acc: 0.6947 - val_pearson_correlation_f: 0.4900
Epoch 6/20
48000/48000 [==============================] - 3s 54us/step - loss: 0.5133 - acc: 0.7114 - pearson_correlation_f: 0.5462 - val_loss: 0.5317 - val_acc: 0.7122 - val_pearson_correlation_f: 0.5231
Epoch 7/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.4786 - acc: 0.7379 - pearson_correlation_f: 0.5941 - val_loss: 0.6100 - val_acc: 0.6758 - val_pearson_correlation_f: 0.4607
Epoch 8/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.4384 - acc: 0.7633 - pearson_correlation_f: 0.6409 - val_loss: 0.5224 - val_acc: 0.7345 - val_pearson_correlation_f: 0.5619
Epoch 9/20
48000/48000 [==============================] - 3s 54us/step - loss: 0.4027 - acc: 0.7929 - pearson_correlation_f: 0.6860 - val_loss: 0.5139 - val_acc: 0.7642 - val_pearson_correlation_f: 0.5961
Epoch 10/20
48000/48000 [==============================] - 3s 54us/step - loss: 0.3540 - acc: 0.8342 - pearson_correlation_f: 0.7415 - val_loss: 0.4698 - val_acc: 0.7987 - val_pearson_correlation_f: 0.6455
Epoch 11/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.3143 - acc: 0.8589 - pearson_correlation_f: 0.7793 - val_loss: 0.4871 - val_acc: 0.8050 - val_pearson_correlation_f: 0.6538
Epoch 12/20
48000/48000 [==============================] - 3s 54us/step - loss: 0.2847 - acc: 0.8728 - pearson_correlation_f: 0.8024 - val_loss: 0.6078 - val_acc: 0.7635 - val_pearson_correlation_f: 0.6176
Epoch 13/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.2580 - acc: 0.8865 - pearson_correlation_f: 0.8245 - val_loss: 0.6096 - val_acc: 0.7752 - val_pearson_correlation_f: 0.6240
Epoch 14/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.2420 - acc: 0.8946 - pearson_correlation_f: 0.8395 - val_loss: 0.6959 - val_acc: 0.7693 - val_pearson_correlation_f: 0.6097
Epoch 15/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.2217 - acc: 0.9026 - pearson_correlation_f: 0.8521 - val_loss: 0.6185 - val_acc: 0.7870 - val_pearson_correlation_f: 0.6194
Epoch 16/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.2104 - acc: 0.9088 - pearson_correlation_f: 0.8616 - val_loss: 0.5850 - val_acc: 0.7988 - val_pearson_correlation_f: 0.6470
Epoch 17/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.1960 - acc: 0.9150 - pearson_correlation_f: 0.8720 - val_loss: 0.8352 - val_acc: 0.7672 - val_pearson_correlation_f: 0.6059
Epoch 18/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.1915 - acc: 0.9206 - pearson_correlation_f: 0.8798 - val_loss: 0.7124 - val_acc: 0.7827 - val_pearson_correlation_f: 0.6125
Epoch 19/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.1763 - acc: 0.9229 - pearson_correlation_f: 0.8865 - val_loss: 0.6278 - val_acc: 0.8100 - val_pearson_correlation_f: 0.6630
Epoch 20/20
48000/48000 [==============================] - 3s 55us/step - loss: 0.1675 - acc: 0.9276 - pearson_correlation_f: 0.8947 - val_loss: 0.6443 - val_acc: 0.8085 - val_pearson_correlation_f: 0.6603
6000/6000 [==============================] - 0s 48us/step
Test result:  [0.6411482437451681, 0.8063333333333333, 0.6597260842323304]
python3 main.py neg glove CNN
Using TensorFlow backend.
Setting:  neg glove 30000 1 CNN None
loading data ..
loading pickle ..
retrieving article ..
merging data ..
creating tokenizer ..
padding ..
shuffling ..
splitting ..
train:  (48000, 640) (48000,)
val:  (6000, 640) (6000,)
test:  (6000, 640) (6000,)
building model ..
Indexing word vectors.
Found 400000 word vectors.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 640)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 640, 100)          14560600  
_________________________________________________________________
conv1d_1 (Conv1D)            (None, 636, 128)          64128     
_________________________________________________________________
max_pooling1d_1 (MaxPooling1 (None, 212, 128)          0         
_________________________________________________________________
global_max_pooling1d_1 (Glob (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 14,641,369
Trainable params: 80,769
Non-trainable params: 14,560,600
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/20
2018-12-08 02:44:45.302091: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-08 02:44:45.394910: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-08 02:44:45.395357: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.75GiB
2018-12-08 02:44:45.395373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-08 02:44:45.557485: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-08 02:44:45.557524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-08 02:44:45.557529: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-08 02:44:45.557676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2450 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
48000/48000 [==============================] - 9s 178us/step - loss: 0.7044 - acc: 0.5261 - pearson_correlation_f: 0.1050 - val_loss: 0.6632 - val_acc: 0.5837 - val_pearson_correlation_f: 0.3521
Epoch 2/20
48000/48000 [==============================] - 7s 152us/step - loss: 0.6336 - acc: 0.6370 - pearson_correlation_f: 0.3825 - val_loss: 0.5933 - val_acc: 0.6847 - val_pearson_correlation_f: 0.4442
Epoch 3/20
48000/48000 [==============================] - 7s 152us/step - loss: 0.5815 - acc: 0.6898 - pearson_correlation_f: 0.4893 - val_loss: 0.5636 - val_acc: 0.7030 - val_pearson_correlation_f: 0.5061
Epoch 4/20
48000/48000 [==============================] - 7s 152us/step - loss: 0.5465 - acc: 0.7215 - pearson_correlation_f: 0.5527 - val_loss: 0.5423 - val_acc: 0.7278 - val_pearson_correlation_f: 0.5274
Epoch 5/20
48000/48000 [==============================] - 7s 152us/step - loss: 0.5121 - acc: 0.7450 - pearson_correlation_f: 0.5994 - val_loss: 0.5407 - val_acc: 0.7268 - val_pearson_correlation_f: 0.5452
Epoch 6/20
48000/48000 [==============================] - 7s 152us/step - loss: 0.4813 - acc: 0.7657 - pearson_correlation_f: 0.6392 - val_loss: 0.5279 - val_acc: 0.7387 - val_pearson_correlation_f: 0.5583
Epoch 7/20
48000/48000 [==============================] - 7s 153us/step - loss: 0.4505 - acc: 0.7863 - pearson_correlation_f: 0.6755 - val_loss: 0.6148 - val_acc: 0.7075 - val_pearson_correlation_f: 0.5506
Epoch 8/20
48000/48000 [==============================] - 7s 155us/step - loss: 0.4270 - acc: 0.8001 - pearson_correlation_f: 0.7012 - val_loss: 0.5280 - val_acc: 0.7488 - val_pearson_correlation_f: 0.5699
Epoch 9/20
48000/48000 [==============================] - 8s 157us/step - loss: 0.4025 - acc: 0.8137 - pearson_correlation_f: 0.7272 - val_loss: 0.5640 - val_acc: 0.7392 - val_pearson_correlation_f: 0.5598
Epoch 10/20
48000/48000 [==============================] - 8s 160us/step - loss: 0.3813 - acc: 0.8235 - pearson_correlation_f: 0.7487 - val_loss: 0.6347 - val_acc: 0.7328 - val_pearson_correlation_f: 0.5628
Epoch 11/20
48000/48000 [==============================] - 8s 160us/step - loss: 0.3571 - acc: 0.8397 - pearson_correlation_f: 0.7694 - val_loss: 0.5723 - val_acc: 0.7505 - val_pearson_correlation_f: 0.5649
Epoch 12/20
48000/48000 [==============================] - 8s 159us/step - loss: 0.3389 - acc: 0.8466 - pearson_correlation_f: 0.7864 - val_loss: 0.7360 - val_acc: 0.6968 - val_pearson_correlation_f: 0.5234
Epoch 13/20
48000/48000 [==============================] - 8s 158us/step - loss: 0.3181 - acc: 0.8589 - pearson_correlation_f: 0.8036 - val_loss: 0.6131 - val_acc: 0.7513 - val_pearson_correlation_f: 0.5680
Epoch 14/20
48000/48000 [==============================] - 8s 160us/step - loss: 0.3020 - acc: 0.8679 - pearson_correlation_f: 0.8163 - val_loss: 0.8221 - val_acc: 0.7198 - val_pearson_correlation_f: 0.5408
Epoch 15/20
48000/48000 [==============================] - 8s 157us/step - loss: 0.2877 - acc: 0.8738 - pearson_correlation_f: 0.8287 - val_loss: 0.6511 - val_acc: 0.7545 - val_pearson_correlation_f: 0.5616
Epoch 16/20
48000/48000 [==============================] - 8s 159us/step - loss: 0.2635 - acc: 0.8866 - pearson_correlation_f: 0.8441 - val_loss: 0.7529 - val_acc: 0.7448 - val_pearson_correlation_f: 0.5539
Epoch 17/20
48000/48000 [==============================] - 8s 158us/step - loss: 0.2499 - acc: 0.8929 - pearson_correlation_f: 0.8537 - val_loss: 0.7473 - val_acc: 0.7485 - val_pearson_correlation_f: 0.5553
Epoch 18/20
48000/48000 [==============================] - 8s 158us/step - loss: 0.2411 - acc: 0.8969 - pearson_correlation_f: 0.8616 - val_loss: 0.7692 - val_acc: 0.7335 - val_pearson_correlation_f: 0.5341
Epoch 19/20
48000/48000 [==============================] - 8s 161us/step - loss: 0.2304 - acc: 0.9019 - pearson_correlation_f: 0.8687 - val_loss: 0.7577 - val_acc: 0.7498 - val_pearson_correlation_f: 0.5504
Epoch 20/20
48000/48000 [==============================] - 8s 160us/step - loss: 0.2136 - acc: 0.9095 - pearson_correlation_f: 0.8796 - val_loss: 0.9249 - val_acc: 0.7418 - val_pearson_correlation_f: 0.5399
6000/6000 [==============================] - 0s 81us/step
Test result:  [0.9001033951441447, 0.7305, 0.532533741792043]
python3 main.py neg glove LSTM
Using TensorFlow backend.
Setting:  neg glove 30000 1 LSTM None
loading data ..
loading pickle ..
retrieving article ..
merging data ..
creating tokenizer ..
padding ..
shuffling ..
splitting ..
train:  (48000, 640) (48000,)
val:  (6000, 640) (6000,)
test:  (6000, 640) (6000,)
building model ..
Indexing word vectors.
Found 400000 word vectors.
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 640)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 640, 100)          14497700  
_________________________________________________________________
lstm_1 (LSTM)                (None, 128)               117248    
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 129       
=================================================================
Total params: 14,615,077
Trainable params: 117,377
Non-trainable params: 14,497,700
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/20
2018-12-08 02:48:04.340187: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-08 02:48:04.435960: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-08 02:48:04.436465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.75GiB
2018-12-08 02:48:04.436480: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-08 02:48:04.592624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-08 02:48:04.592662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-08 02:48:04.592668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-08 02:48:04.592814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2450 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.4958 - pearson_correlation_f: -0.0034 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0075
Epoch 2/20
48000/48000 [==============================] - 243s 5ms/step - loss: 0.6934 - acc: 0.4981 - pearson_correlation_f: -0.0061 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0169
Epoch 3/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.5004 - pearson_correlation_f: 0.0031 - val_loss: 0.6931 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0062
Epoch 4/20
48000/48000 [==============================] - 245s 5ms/step - loss: 0.6933 - acc: 0.5021 - pearson_correlation_f: -0.0016 - val_loss: 0.6931 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0030
Epoch 5/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.5006 - pearson_correlation_f: 0.0022 - val_loss: 0.6934 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0219
Epoch 6/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.4989 - pearson_correlation_f: 0.0033 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0022
Epoch 7/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.5016 - pearson_correlation_f: 0.0046 - val_loss: 0.6933 - val_acc: 0.5000 - val_pearson_correlation_f: 3.5045e-04
Epoch 8/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.4989 - pearson_correlation_f: -0.0026 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0197
Epoch 9/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.5010 - pearson_correlation_f: 0.0045 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0063
Epoch 10/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.5001 - pearson_correlation_f: 0.0031 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0013
Epoch 11/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.4950 - pearson_correlation_f: -0.0062 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0214
Epoch 12/20
48000/48000 [==============================] - 245s 5ms/step - loss: 0.6933 - acc: 0.4976 - pearson_correlation_f: -5.5518e-04 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0083
Epoch 13/20
48000/48000 [==============================] - 245s 5ms/step - loss: 0.6933 - acc: 0.4998 - pearson_correlation_f: -0.0015 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0013
Epoch 14/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6932 - acc: 0.5028 - pearson_correlation_f: 0.0014 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0093
Epoch 15/20
48000/48000 [==============================] - 245s 5ms/step - loss: 0.6932 - acc: 0.5011 - pearson_correlation_f: 0.0091 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0203
Epoch 16/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.4998 - pearson_correlation_f: -0.0025 - val_loss: 0.6931 - val_acc: 0.4998 - val_pearson_correlation_f: 0.0092
Epoch 17/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.4974 - pearson_correlation_f: -0.0015 - val_loss: 0.6931 - val_acc: 0.5007 - val_pearson_correlation_f: 0.0194
Epoch 18/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.4960 - pearson_correlation_f: -0.0059 - val_loss: 0.6932 - val_acc: 0.5003 - val_pearson_correlation_f: -0.0069
Epoch 19/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.4985 - pearson_correlation_f: -0.0058 - val_loss: 0.6934 - val_acc: 0.5000 - val_pearson_correlation_f: -0.0058
Epoch 20/20
48000/48000 [==============================] - 244s 5ms/step - loss: 0.6933 - acc: 0.5001 - pearson_correlation_f: -0.0047 - val_loss: 0.6932 - val_acc: 0.5000 - val_pearson_correlation_f: 0.0080
6000/6000 [==============================] - 38s 6ms/step
Test result:  [0.6932304571469625, 0.5, -0.027406506763150294]
python3 main.py neg USE FC
Using TensorFlow backend.
Setting:  neg USE 30000 1 FC None
loading data ..
loading pickle ..
retrieving article ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (48000, 13, 512) (48000,)
val:  (6000, 13, 512) (6000,)
test:  (6000, 13, 512) (6000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 6656)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               852096    
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 852,225
Trainable params: 852,225
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/20
2018-12-08 04:10:17.354064: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-08 04:10:17.451941: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-08 04:10:17.452408: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.75GiB
2018-12-08 04:10:17.452424: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-08 04:10:17.638868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-08 04:10:17.638905: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-08 04:10:17.638910: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-08 04:10:17.639433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2450 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
48000/48000 [==============================] - 2s 44us/step - loss: 0.6440 - acc: 0.6023 - pearson_correlation_f: 0.2674 - val_loss: 0.5322 - val_acc: 0.7318 - val_pearson_correlation_f: 0.5854
Epoch 2/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.4624 - acc: 0.7902 - pearson_correlation_f: 0.6518 - val_loss: 0.4182 - val_acc: 0.8167 - val_pearson_correlation_f: 0.7008
Epoch 3/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.3638 - acc: 0.8485 - pearson_correlation_f: 0.7518 - val_loss: 0.4125 - val_acc: 0.8207 - val_pearson_correlation_f: 0.7271
Epoch 4/20
48000/48000 [==============================] - 2s 31us/step - loss: 0.3042 - acc: 0.8771 - pearson_correlation_f: 0.8044 - val_loss: 0.3798 - val_acc: 0.8387 - val_pearson_correlation_f: 0.7451
Epoch 5/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.2564 - acc: 0.9021 - pearson_correlation_f: 0.8437 - val_loss: 0.3346 - val_acc: 0.8605 - val_pearson_correlation_f: 0.7690
Epoch 6/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.2153 - acc: 0.9207 - pearson_correlation_f: 0.8741 - val_loss: 0.3324 - val_acc: 0.8635 - val_pearson_correlation_f: 0.7792
Epoch 7/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.1786 - acc: 0.9378 - pearson_correlation_f: 0.8999 - val_loss: 0.3716 - val_acc: 0.8485 - val_pearson_correlation_f: 0.7651
Epoch 8/20
48000/48000 [==============================] - 2s 31us/step - loss: 0.1491 - acc: 0.9497 - pearson_correlation_f: 0.9198 - val_loss: 0.3403 - val_acc: 0.8653 - val_pearson_correlation_f: 0.7819
Epoch 9/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.1235 - acc: 0.9603 - pearson_correlation_f: 0.9363 - val_loss: 0.3301 - val_acc: 0.8738 - val_pearson_correlation_f: 0.7926
Epoch 10/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.1009 - acc: 0.9701 - pearson_correlation_f: 0.9503 - val_loss: 0.3512 - val_acc: 0.8717 - val_pearson_correlation_f: 0.7889
Epoch 11/20
48000/48000 [==============================] - 2s 31us/step - loss: 0.0848 - acc: 0.9755 - pearson_correlation_f: 0.9598 - val_loss: 0.3691 - val_acc: 0.8702 - val_pearson_correlation_f: 0.7878
Epoch 12/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.0692 - acc: 0.9814 - pearson_correlation_f: 0.9685 - val_loss: 0.3660 - val_acc: 0.8758 - val_pearson_correlation_f: 0.7908
Epoch 13/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.0578 - acc: 0.9852 - pearson_correlation_f: 0.9745 - val_loss: 0.3721 - val_acc: 0.8757 - val_pearson_correlation_f: 0.7929
Epoch 14/20
48000/48000 [==============================] - 2s 31us/step - loss: 0.0480 - acc: 0.9879 - pearson_correlation_f: 0.9794 - val_loss: 0.3783 - val_acc: 0.8780 - val_pearson_correlation_f: 0.7960
Epoch 15/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.0401 - acc: 0.9906 - pearson_correlation_f: 0.9832 - val_loss: 0.3970 - val_acc: 0.8773 - val_pearson_correlation_f: 0.7936
Epoch 16/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.0330 - acc: 0.9924 - pearson_correlation_f: 0.9868 - val_loss: 0.4253 - val_acc: 0.8713 - val_pearson_correlation_f: 0.7846
Epoch 17/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.0276 - acc: 0.9937 - pearson_correlation_f: 0.9891 - val_loss: 0.4192 - val_acc: 0.8810 - val_pearson_correlation_f: 0.7984
Epoch 18/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.0244 - acc: 0.9943 - pearson_correlation_f: 0.9902 - val_loss: 0.4575 - val_acc: 0.8768 - val_pearson_correlation_f: 0.7875
Epoch 19/20
48000/48000 [==============================] - 1s 31us/step - loss: 0.0194 - acc: 0.9959 - pearson_correlation_f: 0.9927 - val_loss: 0.4825 - val_acc: 0.8743 - val_pearson_correlation_f: 0.7828
Epoch 20/20
48000/48000 [==============================] - 2s 31us/step - loss: 0.0169 - acc: 0.9963 - pearson_correlation_f: 0.9936 - val_loss: 0.4719 - val_acc: 0.8802 - val_pearson_correlation_f: 0.7898
6000/6000 [==============================] - 0s 41us/step
Test result:  [0.4468432514071465, 0.8821666666666667, 0.8019746872584025]
python3 main.py neg USE CNN
Using TensorFlow backend.
Setting:  neg USE 30000 1 CNN None
loading data ..
loading pickle ..
retrieving article ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (48000, 13, 512) (48000,)
val:  (6000, 13, 512) (6000,)
test:  (6000, 13, 512) (6000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
conv1d_1 (Conv1D)            (None, 9, 128)            327808    
_________________________________________________________________
max_pooling1d_1 (MaxPooling1 (None, 3, 128)            0         
_________________________________________________________________
global_max_pooling1d_1 (Glob (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 344,449
Trainable params: 344,449
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/20
2018-12-08 04:11:00.731904: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-08 04:11:00.843273: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-08 04:11:00.843769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.75GiB
2018-12-08 04:11:00.843788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-08 04:11:01.673750: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-08 04:11:01.673789: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-08 04:11:01.673795: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-08 04:11:01.674274: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2450 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
48000/48000 [==============================] - 4s 88us/step - loss: 0.6553 - acc: 0.5790 - pearson_correlation_f: 0.2319 - val_loss: 0.5253 - val_acc: 0.7430 - val_pearson_correlation_f: 0.5645
Epoch 2/20
48000/48000 [==============================] - 2s 39us/step - loss: 0.4699 - acc: 0.7697 - pearson_correlation_f: 0.6438 - val_loss: 0.4535 - val_acc: 0.7815 - val_pearson_correlation_f: 0.6886
Epoch 3/20
48000/48000 [==============================] - 2s 39us/step - loss: 0.3741 - acc: 0.8320 - pearson_correlation_f: 0.7427 - val_loss: 0.4226 - val_acc: 0.8093 - val_pearson_correlation_f: 0.7242
Epoch 4/20
48000/48000 [==============================] - 2s 38us/step - loss: 0.3153 - acc: 0.8651 - pearson_correlation_f: 0.7949 - val_loss: 0.3403 - val_acc: 0.8533 - val_pearson_correlation_f: 0.7672
Epoch 5/20
48000/48000 [==============================] - 2s 38us/step - loss: 0.2710 - acc: 0.8888 - pearson_correlation_f: 0.8317 - val_loss: 0.3293 - val_acc: 0.8617 - val_pearson_correlation_f: 0.7747
Epoch 6/20
48000/48000 [==============================] - 2s 38us/step - loss: 0.2300 - acc: 0.9072 - pearson_correlation_f: 0.8618 - val_loss: 0.3276 - val_acc: 0.8665 - val_pearson_correlation_f: 0.7805
Epoch 7/20
48000/48000 [==============================] - 2s 38us/step - loss: 0.1997 - acc: 0.9216 - pearson_correlation_f: 0.8839 - val_loss: 0.3336 - val_acc: 0.8678 - val_pearson_correlation_f: 0.7836
Epoch 8/20
48000/48000 [==============================] - 2s 39us/step - loss: 0.1663 - acc: 0.9359 - pearson_correlation_f: 0.9051 - val_loss: 0.3605 - val_acc: 0.8615 - val_pearson_correlation_f: 0.7743
Epoch 9/20
48000/48000 [==============================] - 2s 38us/step - loss: 0.1412 - acc: 0.9472 - pearson_correlation_f: 0.9223 - val_loss: 0.3694 - val_acc: 0.8673 - val_pearson_correlation_f: 0.7805
Epoch 10/20
48000/48000 [==============================] - 2s 38us/step - loss: 0.1193 - acc: 0.9562 - pearson_correlation_f: 0.9352 - val_loss: 0.4199 - val_acc: 0.8533 - val_pearson_correlation_f: 0.7611
Epoch 11/20
48000/48000 [==============================] - 2s 39us/step - loss: 0.1014 - acc: 0.9628 - pearson_correlation_f: 0.9460 - val_loss: 0.4996 - val_acc: 0.8478 - val_pearson_correlation_f: 0.7481
Epoch 12/20
48000/48000 [==============================] - 2s 38us/step - loss: 0.0863 - acc: 0.9688 - pearson_correlation_f: 0.9540 - val_loss: 0.4748 - val_acc: 0.8593 - val_pearson_correlation_f: 0.7636
Epoch 13/20
48000/48000 [==============================] - 2s 39us/step - loss: 0.0715 - acc: 0.9750 - pearson_correlation_f: 0.9626 - val_loss: 0.4760 - val_acc: 0.8623 - val_pearson_correlation_f: 0.7646
Epoch 14/20
48000/48000 [==============================] - 2s 39us/step - loss: 0.0620 - acc: 0.9779 - pearson_correlation_f: 0.9672 - val_loss: 0.5034 - val_acc: 0.8628 - val_pearson_correlation_f: 0.7622
Epoch 15/20
48000/48000 [==============================] - 2s 39us/step - loss: 0.0554 - acc: 0.9805 - pearson_correlation_f: 0.9713 - val_loss: 0.5421 - val_acc: 0.8625 - val_pearson_correlation_f: 0.7591
Epoch 16/20
48000/48000 [==============================] - 2s 39us/step - loss: 0.0445 - acc: 0.9843 - pearson_correlation_f: 0.9766 - val_loss: 0.5691 - val_acc: 0.8625 - val_pearson_correlation_f: 0.7591
Epoch 17/20
48000/48000 [==============================] - 2s 39us/step - loss: 0.0419 - acc: 0.9849 - pearson_correlation_f: 0.9782 - val_loss: 0.6046 - val_acc: 0.8558 - val_pearson_correlation_f: 0.7500
Epoch 18/20
48000/48000 [==============================] - 2s 38us/step - loss: 0.0368 - acc: 0.9876 - pearson_correlation_f: 0.9817 - val_loss: 0.6464 - val_acc: 0.8600 - val_pearson_correlation_f: 0.7501
Epoch 19/20
48000/48000 [==============================] - 2s 39us/step - loss: 0.0337 - acc: 0.9886 - pearson_correlation_f: 0.9829 - val_loss: 0.6917 - val_acc: 0.8583 - val_pearson_correlation_f: 0.7462
Epoch 20/20
48000/48000 [==============================] - 2s 38us/step - loss: 0.0302 - acc: 0.9899 - pearson_correlation_f: 0.9845 - val_loss: 0.6795 - val_acc: 0.8593 - val_pearson_correlation_f: 0.7522
6000/6000 [==============================] - 0s 46us/step
Test result:  [0.6861551486452421, 0.8566666666666667, 0.7470683643023173]
python3 main.py neg USE LSTM
Using TensorFlow backend.
Setting:  neg USE 30000 1 LSTM None
loading data ..
loading pickle ..
retrieving article ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (48000, 13, 512) (48000,)
val:  (6000, 13, 512) (6000,)
test:  (6000, 13, 512) (6000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 128)               328192    
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 129       
=================================================================
Total params: 328,321
Trainable params: 328,321
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/20
2018-12-08 04:11:52.490126: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-08 04:11:52.590020: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-08 04:11:52.590467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.75GiB
2018-12-08 04:11:52.590482: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-08 04:11:52.770745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-08 04:11:52.770782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-08 04:11:52.770788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-08 04:11:52.772806: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2450 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
48000/48000 [==============================] - 9s 192us/step - loss: 0.6851 - acc: 0.5422 - pearson_correlation_f: 0.1244 - val_loss: 0.6610 - val_acc: 0.6002 - val_pearson_correlation_f: 0.2720
Epoch 2/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.6163 - acc: 0.6546 - pearson_correlation_f: 0.3828 - val_loss: 0.5548 - val_acc: 0.7173 - val_pearson_correlation_f: 0.5117
Epoch 3/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.5065 - acc: 0.7515 - pearson_correlation_f: 0.5768 - val_loss: 0.4665 - val_acc: 0.7758 - val_pearson_correlation_f: 0.6274
Epoch 4/20
48000/48000 [==============================] - 8s 169us/step - loss: 0.4426 - acc: 0.7936 - pearson_correlation_f: 0.6566 - val_loss: 0.4242 - val_acc: 0.8063 - val_pearson_correlation_f: 0.6757
Epoch 5/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.3962 - acc: 0.8195 - pearson_correlation_f: 0.7057 - val_loss: 0.3926 - val_acc: 0.8315 - val_pearson_correlation_f: 0.7151
Epoch 6/20
48000/48000 [==============================] - 8s 171us/step - loss: 0.3558 - acc: 0.8445 - pearson_correlation_f: 0.7461 - val_loss: 0.3584 - val_acc: 0.8442 - val_pearson_correlation_f: 0.7444
Epoch 7/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.3234 - acc: 0.8603 - pearson_correlation_f: 0.7763 - val_loss: 0.3400 - val_acc: 0.8535 - val_pearson_correlation_f: 0.7629
Epoch 8/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.2932 - acc: 0.8767 - pearson_correlation_f: 0.8017 - val_loss: 0.3175 - val_acc: 0.8640 - val_pearson_correlation_f: 0.7847
Epoch 9/20
48000/48000 [==============================] - 8s 169us/step - loss: 0.2647 - acc: 0.8906 - pearson_correlation_f: 0.8256 - val_loss: 0.2977 - val_acc: 0.8800 - val_pearson_correlation_f: 0.7991
Epoch 10/20
48000/48000 [==============================] - 8s 169us/step - loss: 0.2403 - acc: 0.9025 - pearson_correlation_f: 0.8452 - val_loss: 0.2846 - val_acc: 0.8817 - val_pearson_correlation_f: 0.8119
Epoch 11/20
48000/48000 [==============================] - 8s 169us/step - loss: 0.2186 - acc: 0.9125 - pearson_correlation_f: 0.8609 - val_loss: 0.2712 - val_acc: 0.8910 - val_pearson_correlation_f: 0.8217
Epoch 12/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.1987 - acc: 0.9209 - pearson_correlation_f: 0.8752 - val_loss: 0.2682 - val_acc: 0.8927 - val_pearson_correlation_f: 0.8262
Epoch 13/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.1804 - acc: 0.9284 - pearson_correlation_f: 0.8880 - val_loss: 0.2686 - val_acc: 0.8958 - val_pearson_correlation_f: 0.8292
Epoch 14/20
48000/48000 [==============================] - 8s 169us/step - loss: 0.1636 - acc: 0.9368 - pearson_correlation_f: 0.9003 - val_loss: 0.2963 - val_acc: 0.8907 - val_pearson_correlation_f: 0.8239
Epoch 15/20
48000/48000 [==============================] - 8s 169us/step - loss: 0.1479 - acc: 0.9429 - pearson_correlation_f: 0.9107 - val_loss: 0.2908 - val_acc: 0.8932 - val_pearson_correlation_f: 0.8264
Epoch 16/20
48000/48000 [==============================] - 8s 169us/step - loss: 0.1317 - acc: 0.9493 - pearson_correlation_f: 0.9206 - val_loss: 0.2916 - val_acc: 0.8967 - val_pearson_correlation_f: 0.8298
Epoch 17/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.1179 - acc: 0.9556 - pearson_correlation_f: 0.9301 - val_loss: 0.3111 - val_acc: 0.8932 - val_pearson_correlation_f: 0.8248
Epoch 18/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.1041 - acc: 0.9597 - pearson_correlation_f: 0.9383 - val_loss: 0.3380 - val_acc: 0.8910 - val_pearson_correlation_f: 0.8190
Epoch 19/20
48000/48000 [==============================] - 8s 171us/step - loss: 0.0920 - acc: 0.9646 - pearson_correlation_f: 0.9460 - val_loss: 0.3460 - val_acc: 0.8955 - val_pearson_correlation_f: 0.8252
Epoch 20/20
48000/48000 [==============================] - 8s 169us/step - loss: 0.0814 - acc: 0.9692 - pearson_correlation_f: 0.9528 - val_loss: 0.3623 - val_acc: 0.8962 - val_pearson_correlation_f: 0.8252
6000/6000 [==============================] - 1s 213us/step
Test result:  [0.4009648665587107, 0.89, 0.8169915692011516]
python3 main.py neg USE-Large FC
Using TensorFlow backend.
Setting:  neg USE-Large 30000 1 FC None
loading data ..
loading pickle ..
retrieving article ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (48000, 13, 512) (48000,)
val:  (6000, 13, 512) (6000,)
test:  (6000, 13, 512) (6000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 6656)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               852096    
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 852,225
Trainable params: 852,225
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/20
2018-12-08 04:14:50.889171: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-08 04:14:50.984737: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-08 04:14:50.985182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.75GiB
2018-12-08 04:14:50.985198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-08 04:14:51.171200: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-08 04:14:51.171236: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-08 04:14:51.171242: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-08 04:14:51.171394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2450 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
48000/48000 [==============================] - 2s 45us/step - loss: 0.6012 - acc: 0.6524 - pearson_correlation_f: 0.3532 - val_loss: 0.3882 - val_acc: 0.8628 - val_pearson_correlation_f: 0.7519
Epoch 2/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.3203 - acc: 0.8791 - pearson_correlation_f: 0.7974 - val_loss: 0.2703 - val_acc: 0.8983 - val_pearson_correlation_f: 0.8317
Epoch 3/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.2312 - acc: 0.9141 - pearson_correlation_f: 0.8616 - val_loss: 0.2349 - val_acc: 0.9137 - val_pearson_correlation_f: 0.8572
Epoch 4/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.1790 - acc: 0.9371 - pearson_correlation_f: 0.8983 - val_loss: 0.2292 - val_acc: 0.9132 - val_pearson_correlation_f: 0.8607
Epoch 5/20
48000/48000 [==============================] - 2s 33us/step - loss: 0.1402 - acc: 0.9523 - pearson_correlation_f: 0.9240 - val_loss: 0.2487 - val_acc: 0.9048 - val_pearson_correlation_f: 0.8553
Epoch 6/20
48000/48000 [==============================] - 2s 33us/step - loss: 0.1082 - acc: 0.9653 - pearson_correlation_f: 0.9439 - val_loss: 0.2092 - val_acc: 0.9238 - val_pearson_correlation_f: 0.8783
Epoch 7/20
48000/48000 [==============================] - 2s 33us/step - loss: 0.0826 - acc: 0.9753 - pearson_correlation_f: 0.9592 - val_loss: 0.2125 - val_acc: 0.9217 - val_pearson_correlation_f: 0.8769
Epoch 8/20
48000/48000 [==============================] - 2s 33us/step - loss: 0.0634 - acc: 0.9819 - pearson_correlation_f: 0.9697 - val_loss: 0.2300 - val_acc: 0.9202 - val_pearson_correlation_f: 0.8732
Epoch 9/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.0493 - acc: 0.9869 - pearson_correlation_f: 0.9778 - val_loss: 0.2297 - val_acc: 0.9243 - val_pearson_correlation_f: 0.8778
Epoch 10/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.0363 - acc: 0.9913 - pearson_correlation_f: 0.9845 - val_loss: 0.2502 - val_acc: 0.9215 - val_pearson_correlation_f: 0.8717
Epoch 11/20
48000/48000 [==============================] - 2s 33us/step - loss: 0.0281 - acc: 0.9935 - pearson_correlation_f: 0.9883 - val_loss: 0.2422 - val_acc: 0.9253 - val_pearson_correlation_f: 0.8779
Epoch 12/20
48000/48000 [==============================] - 2s 33us/step - loss: 0.0221 - acc: 0.9950 - pearson_correlation_f: 0.9912 - val_loss: 0.2579 - val_acc: 0.9207 - val_pearson_correlation_f: 0.8726
Epoch 13/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.0170 - acc: 0.9967 - pearson_correlation_f: 0.9936 - val_loss: 0.3033 - val_acc: 0.9193 - val_pearson_correlation_f: 0.8663
Epoch 14/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.0150 - acc: 0.9968 - pearson_correlation_f: 0.9942 - val_loss: 0.2636 - val_acc: 0.9258 - val_pearson_correlation_f: 0.8759
Epoch 15/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.0110 - acc: 0.9981 - pearson_correlation_f: 0.9961 - val_loss: 0.2741 - val_acc: 0.9265 - val_pearson_correlation_f: 0.8783
Epoch 16/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.0095 - acc: 0.9981 - pearson_correlation_f: 0.9964 - val_loss: 0.2691 - val_acc: 0.9303 - val_pearson_correlation_f: 0.8825
Epoch 17/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.0075 - acc: 0.9985 - pearson_correlation_f: 0.9973 - val_loss: 0.2959 - val_acc: 0.9292 - val_pearson_correlation_f: 0.8814
Epoch 18/20
48000/48000 [==============================] - 2s 33us/step - loss: 0.0069 - acc: 0.9985 - pearson_correlation_f: 0.9973 - val_loss: 0.2973 - val_acc: 0.9293 - val_pearson_correlation_f: 0.8801
Epoch 19/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.0058 - acc: 0.9987 - pearson_correlation_f: 0.9976 - val_loss: 0.3010 - val_acc: 0.9297 - val_pearson_correlation_f: 0.8815
Epoch 20/20
48000/48000 [==============================] - 2s 34us/step - loss: 0.0054 - acc: 0.9987 - pearson_correlation_f: 0.9979 - val_loss: 0.3008 - val_acc: 0.9332 - val_pearson_correlation_f: 0.8833
6000/6000 [==============================] - 0s 39us/step
Test result:  [0.32931442284708223, 0.9278333333333333, 0.8772885157267253]
python3 main.py neg USE-Large CNN
Using TensorFlow backend.
Setting:  neg USE-Large 30000 1 CNN None
loading data ..
loading pickle ..
retrieving article ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (48000, 13, 512) (48000,)
val:  (6000, 13, 512) (6000,)
test:  (6000, 13, 512) (6000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
conv1d_1 (Conv1D)            (None, 9, 128)            327808    
_________________________________________________________________
max_pooling1d_1 (MaxPooling1 (None, 3, 128)            0         
_________________________________________________________________
global_max_pooling1d_1 (Glob (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 344,449
Trainable params: 344,449
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/20
2018-12-08 04:15:34.752599: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-08 04:15:34.832278: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-08 04:15:34.832722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.75GiB
2018-12-08 04:15:34.832743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-08 04:15:35.431431: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-08 04:15:35.431469: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-08 04:15:35.431476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-08 04:15:35.431640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2450 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
48000/48000 [==============================] - 4s 80us/step - loss: 0.6365 - acc: 0.6076 - pearson_correlation_f: 0.2877 - val_loss: 0.5178 - val_acc: 0.7318 - val_pearson_correlation_f: 0.6694
Epoch 2/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.4361 - acc: 0.8049 - pearson_correlation_f: 0.7044 - val_loss: 0.3557 - val_acc: 0.8530 - val_pearson_correlation_f: 0.7588
Epoch 3/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.3554 - acc: 0.8483 - pearson_correlation_f: 0.7760 - val_loss: 0.3725 - val_acc: 0.8395 - val_pearson_correlation_f: 0.7819
Epoch 4/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.3051 - acc: 0.8733 - pearson_correlation_f: 0.8175 - val_loss: 0.2821 - val_acc: 0.8828 - val_pearson_correlation_f: 0.8136
Epoch 5/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.2638 - acc: 0.8930 - pearson_correlation_f: 0.8466 - val_loss: 0.3788 - val_acc: 0.8307 - val_pearson_correlation_f: 0.7796
Epoch 6/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.2300 - acc: 0.9096 - pearson_correlation_f: 0.8708 - val_loss: 0.2682 - val_acc: 0.8928 - val_pearson_correlation_f: 0.8280
Epoch 7/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.2026 - acc: 0.9199 - pearson_correlation_f: 0.8890 - val_loss: 0.3643 - val_acc: 0.8703 - val_pearson_correlation_f: 0.8006
Epoch 8/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.1768 - acc: 0.9307 - pearson_correlation_f: 0.9035 - val_loss: 0.2646 - val_acc: 0.8937 - val_pearson_correlation_f: 0.8304
Epoch 9/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.1575 - acc: 0.9386 - pearson_correlation_f: 0.9149 - val_loss: 0.3494 - val_acc: 0.8843 - val_pearson_correlation_f: 0.8166
Epoch 10/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.1391 - acc: 0.9455 - pearson_correlation_f: 0.9256 - val_loss: 0.2853 - val_acc: 0.8935 - val_pearson_correlation_f: 0.8261
Epoch 11/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.1215 - acc: 0.9545 - pearson_correlation_f: 0.9360 - val_loss: 0.2862 - val_acc: 0.8998 - val_pearson_correlation_f: 0.8338
Epoch 12/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.1077 - acc: 0.9593 - pearson_correlation_f: 0.9434 - val_loss: 0.3437 - val_acc: 0.8942 - val_pearson_correlation_f: 0.8275
Epoch 13/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.0969 - acc: 0.9648 - pearson_correlation_f: 0.9501 - val_loss: 0.3573 - val_acc: 0.8758 - val_pearson_correlation_f: 0.8043
Epoch 14/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.0869 - acc: 0.9674 - pearson_correlation_f: 0.9556 - val_loss: 0.3547 - val_acc: 0.8972 - val_pearson_correlation_f: 0.8301
Epoch 15/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.0768 - acc: 0.9711 - pearson_correlation_f: 0.9600 - val_loss: 0.5915 - val_acc: 0.8178 - val_pearson_correlation_f: 0.7282
Epoch 16/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.0704 - acc: 0.9745 - pearson_correlation_f: 0.9643 - val_loss: 0.8078 - val_acc: 0.8455 - val_pearson_correlation_f: 0.7533
Epoch 17/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.0645 - acc: 0.9772 - pearson_correlation_f: 0.9679 - val_loss: 0.3944 - val_acc: 0.8998 - val_pearson_correlation_f: 0.8292
Epoch 18/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.0609 - acc: 0.9784 - pearson_correlation_f: 0.9695 - val_loss: 0.3797 - val_acc: 0.8970 - val_pearson_correlation_f: 0.8258
Epoch 19/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.0534 - acc: 0.9815 - pearson_correlation_f: 0.9737 - val_loss: 0.4080 - val_acc: 0.8998 - val_pearson_correlation_f: 0.8275
Epoch 20/20
48000/48000 [==============================] - 2s 37us/step - loss: 0.0509 - acc: 0.9825 - pearson_correlation_f: 0.9747 - val_loss: 0.3966 - val_acc: 0.8997 - val_pearson_correlation_f: 0.8262
6000/6000 [==============================] - 0s 44us/step
Test result:  [0.4135591408610344, 0.8955, 0.8265138319333394]
python3 main.py neg USE-Large LSTM
Using TensorFlow backend.
Setting:  neg USE-Large 30000 1 LSTM None
loading data ..
loading pickle ..
retrieving article ..
merging data ..
padding ..
shuffling ..
splitting ..
train:  (48000, 13, 512) (48000,)
val:  (6000, 13, 512) (6000,)
test:  (6000, 13, 512) (6000,)
building model ..
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
lstm_1 (LSTM)                (None, 128)               328192    
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 129       
=================================================================
Total params: 328,321
Trainable params: 328,321
Non-trainable params: 0
_________________________________________________________________
training ..
Train on 48000 samples, validate on 6000 samples
Epoch 1/20
2018-12-08 04:16:21.558347: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-12-08 04:16:21.637857: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:964] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-12-08 04:16:21.638381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1432] Found device 0 with properties: 
name: GeForce GTX 1060 3GB major: 6 minor: 1 memoryClockRate(GHz): 1.7085
pciBusID: 0000:0b:00.0
totalMemory: 2.95GiB freeMemory: 2.75GiB
2018-12-08 04:16:21.638398: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1511] Adding visible gpu devices: 0
2018-12-08 04:16:21.822394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:982] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-12-08 04:16:21.822429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:988]      0 
2018-12-08 04:16:21.822434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1001] 0:   N 
2018-12-08 04:16:21.822581: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 2450 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1060 3GB, pci bus id: 0000:0b:00.0, compute capability: 6.1)
48000/48000 [==============================] - 9s 192us/step - loss: 0.6934 - acc: 0.5091 - pearson_correlation_f: 0.0150 - val_loss: 0.6929 - val_acc: 0.4845 - val_pearson_correlation_f: 0.0342
Epoch 2/20
48000/48000 [==============================] - 8s 172us/step - loss: 0.6630 - acc: 0.5760 - pearson_correlation_f: 0.2057 - val_loss: 0.5818 - val_acc: 0.7008 - val_pearson_correlation_f: 0.4587
Epoch 3/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.5440 - acc: 0.7196 - pearson_correlation_f: 0.5141 - val_loss: 0.4790 - val_acc: 0.7775 - val_pearson_correlation_f: 0.6143
Epoch 4/20
48000/48000 [==============================] - 8s 172us/step - loss: 0.4466 - acc: 0.8003 - pearson_correlation_f: 0.6550 - val_loss: 0.3932 - val_acc: 0.8352 - val_pearson_correlation_f: 0.7219
Epoch 5/20
48000/48000 [==============================] - 8s 171us/step - loss: 0.3711 - acc: 0.8460 - pearson_correlation_f: 0.7396 - val_loss: 0.3383 - val_acc: 0.8675 - val_pearson_correlation_f: 0.7705
Epoch 6/20
48000/48000 [==============================] - 8s 172us/step - loss: 0.3229 - acc: 0.8748 - pearson_correlation_f: 0.7865 - val_loss: 0.2980 - val_acc: 0.8828 - val_pearson_correlation_f: 0.8075
Epoch 7/20
48000/48000 [==============================] - 8s 172us/step - loss: 0.2807 - acc: 0.8943 - pearson_correlation_f: 0.8217 - val_loss: 0.2633 - val_acc: 0.8975 - val_pearson_correlation_f: 0.8327
Epoch 8/20
48000/48000 [==============================] - 8s 171us/step - loss: 0.2464 - acc: 0.9088 - pearson_correlation_f: 0.8478 - val_loss: 0.2452 - val_acc: 0.9063 - val_pearson_correlation_f: 0.8494
Epoch 9/20
48000/48000 [==============================] - 8s 169us/step - loss: 0.2207 - acc: 0.9188 - pearson_correlation_f: 0.8662 - val_loss: 0.2289 - val_acc: 0.9098 - val_pearson_correlation_f: 0.8574
Epoch 10/20
48000/48000 [==============================] - 8s 172us/step - loss: 0.1947 - acc: 0.9294 - pearson_correlation_f: 0.8841 - val_loss: 0.2185 - val_acc: 0.9163 - val_pearson_correlation_f: 0.8657
Epoch 11/20
48000/48000 [==============================] - 8s 171us/step - loss: 0.1739 - acc: 0.9369 - pearson_correlation_f: 0.8978 - val_loss: 0.2227 - val_acc: 0.9175 - val_pearson_correlation_f: 0.8671
Epoch 12/20
48000/48000 [==============================] - 8s 171us/step - loss: 0.1546 - acc: 0.9443 - pearson_correlation_f: 0.9095 - val_loss: 0.2056 - val_acc: 0.9237 - val_pearson_correlation_f: 0.8755
Epoch 13/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.1382 - acc: 0.9503 - pearson_correlation_f: 0.9209 - val_loss: 0.2153 - val_acc: 0.9215 - val_pearson_correlation_f: 0.8738
Epoch 14/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.1199 - acc: 0.9571 - pearson_correlation_f: 0.9317 - val_loss: 0.2028 - val_acc: 0.9282 - val_pearson_correlation_f: 0.8829
Epoch 15/20
48000/48000 [==============================] - 8s 171us/step - loss: 0.1042 - acc: 0.9624 - pearson_correlation_f: 0.9408 - val_loss: 0.2530 - val_acc: 0.9148 - val_pearson_correlation_f: 0.8613
Epoch 16/20
48000/48000 [==============================] - 8s 172us/step - loss: 0.0902 - acc: 0.9669 - pearson_correlation_f: 0.9491 - val_loss: 0.2266 - val_acc: 0.9258 - val_pearson_correlation_f: 0.8784
Epoch 17/20
48000/48000 [==============================] - 8s 172us/step - loss: 0.0791 - acc: 0.9716 - pearson_correlation_f: 0.9555 - val_loss: 0.2452 - val_acc: 0.9283 - val_pearson_correlation_f: 0.8802
Epoch 18/20
48000/48000 [==============================] - 8s 170us/step - loss: 0.0698 - acc: 0.9755 - pearson_correlation_f: 0.9611 - val_loss: 0.2381 - val_acc: 0.9292 - val_pearson_correlation_f: 0.8832
Epoch 19/20
48000/48000 [==============================] - 8s 172us/step - loss: 0.0597 - acc: 0.9790 - pearson_correlation_f: 0.9673 - val_loss: 0.2575 - val_acc: 0.9295 - val_pearson_correlation_f: 0.8799
Epoch 20/20
48000/48000 [==============================] - 8s 171us/step - loss: 0.0535 - acc: 0.9821 - pearson_correlation_f: 0.9713 - val_loss: 0.2594 - val_acc: 0.9270 - val_pearson_correlation_f: 0.8761
6000/6000 [==============================] - 1s 213us/step
Test result:  [0.27802763018012044, 0.9258333333333333, 0.8751404730478922]
