#+TITLE: Architecture Detail

* Data dimension for each embedding method

** Glove
train:  (8000, 640) (8000,)
val:  (1000, 640) (1000,)
test:  (1000, 640) (1000,)


- 8000, 1000, 1000 is the number of training/validation/testing data points
- 640 is dimension of each data point (512 + 128)

** USE
train:  (8000, 13, 512) (8000,)
val:  (1000, 13, 512) (1000,)
test:  (1000, 13, 512) (1000,)

- 13 is the dimension of each data point. (10 + 3)
- 512 is the sentence embedding output dimension, i.e. each sentence
  is embedded into a 512-dim vector of float.

** USE-Transformer
train:  (8000, 13, 512) (8000,)
val:  (1000, 13, 512) (1000,)
test:  (1000, 13, 512) (1000,)

** InferSent

train:  (8000, 13, 4096) (8000,)
val:  (1000, 13, 4096) (1000,)
test:  (1000, 13, 4096) (1000,)

- 4096 is the sentence embedding output dimension of InferSent

* CNN

** glove CNN

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 640)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 640, 100)          6613500   
_________________________________________________________________
conv1d_1 (Conv1D)            (None, 636, 128)          64128     
_________________________________________________________________
max_pooling1d_1 (MaxPooling1 (None, 212, 128)          0         
_________________________________________________________________
global_max_pooling1d_1 (Glob (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 6,694,269
Trainable params: 80,769
Non-trainable params: 6,613,500
_________________________________________________________________

** USE CNN
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
conv1d_2 (Conv1D)            (None, 9, 128)            327808    
_________________________________________________________________
max_pooling1d_2 (MaxPooling1 (None, 3, 128)            0         
_________________________________________________________________
global_max_pooling1d_2 (Glob (None, 128)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 129       
=================================================================
Total params: 344,449
Trainable params: 344,449
Non-trainable params: 0


** USE-Transformer CNN
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
conv1d_3 (Conv1D)            (None, 9, 128)            327808    
_________________________________________________________________
max_pooling1d_3 (MaxPooling1 (None, 3, 128)            0         
_________________________________________________________________
global_max_pooling1d_3 (Glob (None, 128)               0         
_________________________________________________________________
dense_5 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_6 (Dense)              (None, 1)                 129       
=================================================================
Total params: 344,449
Trainable params: 344,449
Non-trainable params: 0
_________________________________________________________________


** InferSent CNN
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 13, 4096)          0         
_________________________________________________________________
conv1d_4 (Conv1D)            (None, 9, 128)            2621568   
_________________________________________________________________
max_pooling1d_4 (MaxPooling1 (None, 3, 128)            0         
_________________________________________________________________
global_max_pooling1d_4 (Glob (None, 128)               0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               16512     
_________________________________________________________________
dense_8 (Dense)              (None, 1)                 129       
=================================================================
Total params: 2,638,209
Trainable params: 2,638,209
Non-trainable params: 0
_________________________________________________________________

* Fully Connected

** glove FC

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 640)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 640, 100)          6643000   
_________________________________________________________________
flatten_1 (Flatten)          (None, 64000)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 128)               8192128   
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 14,835,257
Trainable params: 8,192,257
Non-trainable params: 6,643,000
_________________________________________________________________

** USE FC

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 6656)              0         
_________________________________________________________________
dense_3 (Dense)              (None, 128)               852096    
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 129       
=================================================================
Total params: 852,225
Trainable params: 852,225
Non-trainable params: 0
_________________________________________________________________

** USE-Transformer FC

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 6656)              0         
_________________________________________________________________
dense_5 (Dense)              (None, 128)               852096    
_________________________________________________________________
dense_6 (Dense)              (None, 1)                 129       
=================================================================
Total params: 852,225
Trainable params: 852,225
Non-trainable params: 0
_________________________________________________________________

** InferSent FC

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 13, 4096)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 53248)             0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               6815872   
_________________________________________________________________
dense_8 (Dense)              (None, 1)                 129       
=================================================================
Total params: 6,816,001
Trainable params: 6,816,001
Non-trainable params: 0
_________________________________________________________________

* LSTM

** Glove LSTM

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         (None, 640)               0         
_________________________________________________________________
embedding_1 (Embedding)      (None, 640, 100)          6626900   
_________________________________________________________________
lstm_1 (LSTM)                (None, 128)               117248    
_________________________________________________________________
dropout_1 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 129       
=================================================================
Total params: 6,744,277
Trainable params: 117,377
Non-trainable params: 6,626,900
_________________________________________________________________

** USE LSTM

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_2 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 128)               328192    
_________________________________________________________________
dropout_2 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 129       
=================================================================
Total params: 328,321
Trainable params: 328,321
Non-trainable params: 0
_________________________________________________________________

** USE-Transformer LSTM
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_3 (InputLayer)         (None, 13, 512)           0         
_________________________________________________________________
lstm_3 (LSTM)                (None, 128)               328192    
_________________________________________________________________
dropout_3 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_3 (Dense)              (None, 1)                 129       
=================================================================
Total params: 328,321
Trainable params: 328,321
Non-trainable params: 0
_________________________________________________________________

** InferSent LSTM


_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_4 (InputLayer)         (None, 13, 4096)          0         
_________________________________________________________________
lstm_4 (LSTM)                (None, 128)               2163200   
_________________________________________________________________
dropout_4 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_4 (Dense)              (None, 1)                 129       
=================================================================
Total params: 2,163,329
Trainable params: 2,163,329
Non-trainable params: 0
_________________________________________________________________

